"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[213],{409:(e,t,n)=>{n.d(t,{A:()=>o});function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window;try{n.gtag("event",e,t)}catch(e){console.log("error sending gtag event",e)}}},858:(e,t,n)=>{n.d(t,{W:()=>l,a:()=>r});let o=[];function r(){try{return window.self!==window.top}catch(e){return!0}}function l(){try{return r()&&o.some(e=>{var t,n,o;return(null!=(o=null==(n=window)||null==(t=n.location)?void 0:t.ancestorOrigins[0])?o:document.referrer).includes(e)})}catch(e){return console.error("Piracy detection error",e),!1}}},1213:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(7876),r=n(3679),l=n(4679),a=n(6336),s=n(1173),i=n(409);function c(e){var t,n,l,c,u,d;let{session:g,openAccountModal:h,navbarMode:m,inCrazyGames:p}=e,{t:f}=(0,s.B)("common");return!p||g&&(null==g||null==(t=g.token)?void 0:t.secret)?(0,o.jsx)(o.Fragment,{children:g&&(null==g||null==(n=g.token)?void 0:n.secret)?(0,o.jsx)("button",{className:"gameBtn ".concat(m?"navBtn":"accountBtn loggedIn"," ").concat((null==g||null==(c=g.token)?void 0:c.supporter)?"supporterBtn":""),onClick:()=>{h()},children:(null==g||null==(u=g.token)?void 0:u.username)?(0,o.jsx)("p",{style:{color:"white",paddingRight:"-13px",marginLeft:"0px",fontSize:"1.4em",fontWeight:700},children:null==g||null==(d=g.token)?void 0:d.username}):null}):(0,o.jsx)("button",{className:"gameBtn ".concat(m?"navBtn":"accountBtn"),disabled:p,onClick:()=>{null===g&&((0,i.A)("login_attempt"),(0,a.Jv)("google"))},children:(null==g||null==(l=g.token)?void 0:l.secret)||null===g?(0,o.jsx)("div",{style:{marginRight:"10px",marginLeft:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:p?(0,o.jsx)(o.Fragment,{children:"..."}):(0,o.jsxs)(o.Fragment,{children:[f("login"),"\xa0\xa0",(0,o.jsx)(r.DSS,{className:"home__squarebtnicon"})]})}):"..."})}):null}var u=n(6059),d=n(4250),g=n(4232);function h(e){let{connected:t,shown:n,onClick:r,connecting:l}=e,[a,s]=(0,g.useState)(!1),[i,c]=(0,g.useState)(!1),[h,m]=(0,g.useState)(!1),p=(0,g.useRef)(t),f=(0,g.useRef)(l),w=(0,g.useRef)(null),x=(0,g.useRef)(null),b=(0,g.useRef)(null);if((0,g.useEffect)(()=>{let e=p.current,n=f.current;(w.current&&(clearTimeout(w.current),w.current=null),x.current&&(clearTimeout(x.current),x.current=null),l)?n?(b.current?Date.now()-b.current:0)>=3e3&&(s(!0),c(!1),m(!1)):(b.current=Date.now(),s(!1),c(!1),m(!1),x.current=setTimeout(()=>{s(!0),c(!1),m(!0),setTimeout(()=>m(!1),400)},3e3)):t?t&&!e?(b.current?Date.now()-b.current:0)>=3e3?(s(!0),c(!1),m(!1),w.current=setTimeout(()=>{c(!0),setTimeout(()=>{s(!1),c(!1)},400)},1500)):(s(!1),c(!1),m(!1)):t&&(s(!1),c(!1),m(!1)):(s(!0),c(!1),m(!0),setTimeout(()=>m(!1),400)),p.current=t,f.current=l},[t,l]),(0,g.useEffect)(()=>()=>{w.current&&clearTimeout(w.current),x.current&&clearTimeout(x.current)},[]),!n||!a)return null;let v=()=>t?"#22c55e":l?"#f59e0b":"#ef4444";return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(d,{id:"a7d97ecb79e7aa48",children:"@keyframes pulse-connect{0%,100%{transform:scale(1);box-shadow:0 4px 16px rgba(0,0,0,.4)}50%{transform:scale(1.05);box-shadow:0 6px 20px rgba(245,158,11,.6)}}@keyframes pulse-disconnect{0%,100%{box-shadow:0 4px 16px rgba(0,0,0,.4)}50%{box-shadow:0 6px 20px rgba(239,68,68,.6)}}"}),(0,o.jsx)("div",{onClick:r,style:{position:"fixed",top:"100px",right:i||h?"-85px":"15px",zIndex:1e4,width:"50px",height:"50px",borderRadius:"15px",backgroundColor:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:r?"pointer":"default",boxShadow:"0 4px 16px rgba(0,0,0,0.4)",transition:"right 0.4s ease-in-out, transform 0.4s ease-in-out, all 0.3s ease",border:"3px solid ".concat(v()),pointerEvents:"auto",animation:i||h?"none":l?"pulse-connect 1s ease-in-out infinite":t?"none":"pulse-disconnect 2s ease-in-out infinite",transform:h?"translateX(100px)":"translateX(0)"},onMouseEnter:e=>{l||(e.target.style.transform="scale(1.1)",e.target.style.boxShadow="0 6px 20px rgba(0,0,0,0.5)")},onMouseLeave:e=>{l||(e.target.style.transform="scale(1)",e.target.style.boxShadow="0 4px 16px rgba(0,0,0,0.4)")},title:t?"Connected to server":l?"Connecting to server...":"Connection lost - Click for details",className:"jsx-a7d97ecb79e7aa48",children:(0,o.jsx)(u._8$,{size:28,color:v()})})]})}function m(e){var t,n,a,i;let{maintenance:d,joinCodePress:m,inCrazyGames:p,inCoolMathGames:f,inGame:w,openAccountModal:x,shown:b,backBtnPressed:v,reloadBtnPressed:y,setGameOptionsModalShown:k,onNavbarPress:j,onFriendsPress:C,gameOptions:_,session:R,screen:A,multiplayerState:S,loading:B,gameOptionsModalShown:N,accountModalOpen:T,selectCountryModalShown:F,mapModalOpen:I,onConnectionError:M}=e,{t:D}=(0,s.B)("common"),E=((null==S?void 0:S.inGame)||"singleplayer"===A)&&!B&&!((null==S?void 0:S.inGame)&&(null==S||null==(t=S.gameData)?void 0:t.state)==="waiting"),[z,P]=(0,g.useState)(!0);return(0,g.useEffect)(()=>{window.location.search.includes("app=true")&&P(!1)},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"navbar ".concat(b?"":"hidden"," ").concat("home"==A?"":"navbarColor"," ").concat("onboarding"===A?"onboarding":""),children:[(0,o.jsxs)("div",{className:"nonHome ".concat("home"===A?"":"shown"),children:[!I&&(0,o.jsx)("h1",{className:"navbar__title desktop",onClick:j,children:"WorldGuessr"}),!I&&(0,o.jsx)("h1",{className:"navbar__title mobile",onClick:j,children:"WG"}),!N&&!T&&!F&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{className:"gameBtn navBtn backBtn ".concat("onboarding"===A?"g2_blue_button":"g2_red_button"," desktop"),onClick:v,children:D("onboarding"===A?"menu":"back")}),(0,o.jsx)("button",{className:"gameBtn navBtn backBtn ".concat("onboarding"===A?"g2_blue_button":"g2_red_button"," mobile"),onClick:v,children:(0,o.jsx)(r.QVr,{})})]})]}),E&&!T&&!N&&(0,o.jsx)("button",{className:"gameBtn navBtn backBtn reloadBtn g2_blue_button",onClick:y,children:(0,o.jsx)("img",{src:"/return.png",alt:"reload",height:13,style:{filter:"invert(1)",transform:"scale(1.5)"}})}),(0,o.jsx)(h,{connected:null==S?void 0:S.connected,connecting:null==S?void 0:S.connecting,shown:!0,onClick:(null==S?void 0:S.connected)?void 0:M}),"multiplayer"===A&&(null==S?void 0:S.inGame)&&(null==S||null==(n=S.gameData)?void 0:n.players.length)>0&&(0,o.jsxs)("span",{id:"playerCnt",className:"bigSpan",children:["\xa0 ",(0,o.jsx)(r.x$1,{})," ",S.gameData.players.length]}),(0,o.jsxs)("div",{className:"navbar__right",children:["singleplayer"===A&&!T&&(0,o.jsxs)("button",{className:"gameBtn navBtn g2_green_button g2_lexend",disabled:B,onClick:()=>k(!0),children:["all"!==_.location&&_.location?(null==_?void 0:_.countryMap)?(0,l.A)(_.location):null==_?void 0:_.communityMapName:D("allCountries"),_.nm&&_.npz?", NMPZ":_.nm?", NM":_.npz?", NPZ":"","\xa0",(0,o.jsx)(u.dgZ,{size:20})]}),"onboarding"===A&&(0,o.jsx)("button",{className:"gameBtn navBtn",style:{backgroundColor:"blue"},onClick:m,children:D("joinGame")}),!w&&z&&!f&&!T&&!I&&(0,o.jsx)(c,{inCrazyGames:p,session:R,navbarMode:"home"!==A,openAccountModal:x}),(null==R||null==(a=R.token)?void 0:a.secret)&&!T&&!N&&!I&&!["getready","guess"].includes(null==S||null==(i=S.gameData)?void 0:i.state)&&(0,o.jsx)("button",{className:"gameBtn friendBtn ".concat("home"===A?"friendBtnFixed":""),onClick:C,disabled:!(null==S?void 0:S.connected),children:(0,o.jsx)(r.M5n,{size:40,className:"friendBtnIcon ".concat("home"===A?"friendBtnIconFixed":"")})})]})]})})}},4679:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(6107);let r={GB:"United Kingdom",US:"United States",RU:"Russia",KR:"South Korea"};function l(e){var t;return null!=(t=r[e])?t:o.JJ(e)}},6336:(e,t,n)=>{n.d(t,{CI:()=>s,Jv:()=>i,dJ:()=>u,wV:()=>c});var o=n(858),r=n(2446),l=n(8207);let a=!1;function s(){window.localStorage.removeItem("wg_secret"),a=null,window.dontReconnect||(console.log("Removing cookies"),function(){for(var e=document.cookie.split("; "),t=0;t<e.length;t++)for(var n=window.location.hostname.split(".");n.length>0;){var o=encodeURIComponent(e[t].split(";")[0].split("=")[0])+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain="+n.join(".")+" ;path=",r=location.pathname.split("/");for(document.cookie=o+"/";r.length>0;)document.cookie=o+r.join("/"),console.log(o+r.join("/")),r.pop();n.shift()}}(),window.location.reload())}function i(){if(console.log("Signing in"),(0,o.a)()){console.log("In iframe");let e=window.location.href;window.open(e,"_blank")}window.login()}function c(){var e,t;if(window.location.hostname.includes("crazygames")&&window.verifyPayload&&"not_logged_in"===JSON.parse(window.verifyPayload).secret)return{data:null};if(!1===a&&!window.fetchingSession&&(null==(e=window.cConfig)?void 0:e.apiUrl)){let e=null;try{e=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}e?(window.fetchingSession=!0,console.log("[Auth] Starting authentication with retry mechanism"),l.A.fetchWithRetry((null==(t=window.cConfig)?void 0:t.apiUrl)+"/api/googleAuth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:e})},"googleAuth").then(e=>e.json()).then(e=>{if(window.fetchingSession=!1,console.log("[Auth] Authentication successful"),e.error){console.error("[Auth] Server error:",e.error),a=null;return}e.secret?(window.localStorage.setItem("wg_secret",e.secret),a={token:e},console.log("[Auth] Session established for user:",e.username)):(console.log("[Auth] No session data received, user not logged in"),a=null)}).catch(e=>{window.fetchingSession=!1,console.error("[Auth] Authentication failed after all retries:",e.message);try{window.localStorage.removeItem("wg_secret")}catch(e){console.warn("[Auth] Could not clear localStorage:",e)}a=null,l.A.getRetryCount("googleAuth")>=5&&r.oR.error("Connection issues detected. Please refresh the page if problems persist.")})):a=null}return{data:a}}function u(){var e;let t=null;if(a&&(null==a||null==(e=a.token)?void 0:e.secret))t=a.secret;else try{t=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}return t?{Authorization:"Bearer "+t}:{}}},8207:(e,t,n)=>{n.d(t,{A:()=>r});class o{async fetchWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=this.retryAttempts.get(n)||0;console.log("[RetryFetch] Attempting ".concat(n," (attempt ").concat(o+1,"/").concat(this.maxRetries+1,")"));try{let o=new AbortController,r=setTimeout(()=>o.abort(),1e4),l=await fetch(e,{...t,signal:o.signal});if(clearTimeout(r),!l.ok)throw Error("HTTP ".concat(l.status,": ").concat(l.statusText));return this.retryAttempts.delete(n),console.log("[RetryFetch] Success for ".concat(n)),l}catch(r){if(console.warn("[RetryFetch] Error for ".concat(n,":"),r.message),o<this.maxRetries&&this.shouldRetry(r)){let r=Math.min(this.baseDelay*Math.pow(2,o),this.maxDelay);return console.log("[RetryFetch] Retrying ".concat(n," in ").concat(r,"ms...")),this.retryAttempts.set(n,o+1),new Promise(o=>{setTimeout(()=>{o(this.fetchWithRetry(e,t,n))},r)})}throw console.error("[RetryFetch] Failed ".concat(n," after ").concat(o+1," attempts:"),r.message),this.retryAttempts.delete(n),r}}shouldRetry(e){return"AbortError"===e.name||"TypeError"===e.name||e.message&&e.message.includes("fetch")||e.message&&e.message.includes("HTTP 5")}resetRetries(e){this.retryAttempts.delete(e),console.log("[RetryFetch] Reset retry count for ".concat(e))}getRetryCount(e){return this.retryAttempts.get(e)||0}constructor(){this.retryAttempts=new Map,this.maxRetries=5,this.baseDelay=1e3,this.maxDelay=3e4}}let r=new o}}]);