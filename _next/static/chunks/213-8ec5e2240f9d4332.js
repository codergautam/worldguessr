"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[213],{409:(e,t,n)=>{n.d(t,{A:()=>o});function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window;try{n.gtag("event",e,t)}catch(e){console.log("error sending gtag event",e)}}},858:(e,t,n)=>{n.d(t,{W:()=>l,a:()=>r});let o=[];function r(){try{return window.self!==window.top}catch(e){return!0}}function l(){try{return r()&&o.some(e=>{var t,n,o;return(null!=(o=null==(n=window)||null==(t=n.location)?void 0:t.ancestorOrigins[0])?o:document.referrer).includes(e)})}catch(e){return console.error("Piracy detection error",e),!1}}},1213:(e,t,n)=>{n.d(t,{A:()=>p});var o=n(7876),r=n(3679),l=n(4679),a=n(6336),s=n(1173),i=n(409),c=n(4232),u=n(4279);function d(e){var t,n,l,d,g,h,m;let{session:p,openAccountModal:f,navbarMode:w,inCrazyGames:x}=e,{t:y}=(0,s.B)("common"),[b,v]=(0,c.useState)(null);return((0,c.useEffect)(()=>{var e;(null==p||null==(e=p.token)?void 0:e.accountId)&&fetch(window.cConfig.apiUrl+"/api/publicAccount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:p.token.accountId})}).then(e=>e.json()).then(e=>v(e.countryCode||null)).catch(e=>console.error("Error loading country:",e))},[null==p||null==(t=p.token)?void 0:t.accountId]),!x||p&&(null==p||null==(n=p.token)?void 0:n.secret))?(0,o.jsx)(o.Fragment,{children:p&&(null==p||null==(l=p.token)?void 0:l.secret)?(0,o.jsx)("button",{className:"gameBtn ".concat(w?"navBtn":"accountBtn loggedIn"," ").concat((null==p||null==(g=p.token)?void 0:g.supporter)?"supporterBtn":""),onClick:()=>{f()},children:(null==p||null==(h=p.token)?void 0:h.username)?(0,o.jsxs)("p",{style:{color:"white",paddingRight:"-13px",marginLeft:"0px",fontSize:"1.4em",fontWeight:700,display:"flex",alignItems:"center",gap:"6px"},children:[null==p||null==(m=p.token)?void 0:m.username,b&&(0,o.jsx)(u.A,{countryCode:b,style:{fontSize:"1em"}})]}):null}):(0,o.jsx)("button",{className:"gameBtn ".concat(w?"navBtn":"accountBtn"),disabled:x,onClick:()=>{null===p&&((0,i.A)("login_attempt"),(0,a.Jv)("google"))},children:(null==p||null==(d=p.token)?void 0:d.secret)||null===p?(0,o.jsx)("div",{style:{marginRight:"10px",marginLeft:"10px",display:"flex",alignItems:"center",justifyContent:"center"},children:x?(0,o.jsx)(o.Fragment,{children:"..."}):(0,o.jsxs)(o.Fragment,{children:[y("login"),"\xa0\xa0",(0,o.jsx)(r.DSS,{className:"home__squarebtnicon"})]})}):"..."})}):null}var g=n(6059),h=n(4250);function m(e){let{connected:t,shown:n,onClick:r,connecting:l}=e,[a,s]=(0,c.useState)(!1),[i,u]=(0,c.useState)(!1),[d,m]=(0,c.useState)(!1),p=(0,c.useRef)(t),f=(0,c.useRef)(l),w=(0,c.useRef)(null),x=(0,c.useRef)(null),y=(0,c.useRef)(null);if((0,c.useEffect)(()=>{let e=p.current,n=f.current;(w.current&&(clearTimeout(w.current),w.current=null),x.current&&(clearTimeout(x.current),x.current=null),l)?n?(y.current?Date.now()-y.current:0)>=3e3&&(s(!0),u(!1),m(!1)):(y.current=Date.now(),s(!1),u(!1),m(!1),x.current=setTimeout(()=>{s(!0),u(!1),m(!0),setTimeout(()=>m(!1),400)},3e3)):t?t&&!e?(y.current?Date.now()-y.current:0)>=3e3?(s(!0),u(!1),m(!1),w.current=setTimeout(()=>{u(!0),setTimeout(()=>{s(!1),u(!1)},400)},1500)):(s(!1),u(!1),m(!1)):t&&(s(!1),u(!1),m(!1)):(s(!0),u(!1),m(!0),setTimeout(()=>m(!1),400)),p.current=t,f.current=l},[t,l]),(0,c.useEffect)(()=>()=>{w.current&&clearTimeout(w.current),x.current&&clearTimeout(x.current)},[]),!n||!a)return null;let b=()=>t?"#22c55e":l?"#f59e0b":"#ef4444";return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(h,{id:"a7d97ecb79e7aa48",children:"@keyframes pulse-connect{0%,100%{transform:scale(1);box-shadow:0 4px 16px rgba(0,0,0,.4)}50%{transform:scale(1.05);box-shadow:0 6px 20px rgba(245,158,11,.6)}}@keyframes pulse-disconnect{0%,100%{box-shadow:0 4px 16px rgba(0,0,0,.4)}50%{box-shadow:0 6px 20px rgba(239,68,68,.6)}}"}),(0,o.jsx)("div",{onClick:r,style:{position:"fixed",top:"100px",right:i||d?"-85px":"15px",zIndex:1e4,width:"50px",height:"50px",borderRadius:"15px",backgroundColor:"rgba(0, 0, 0, 0.8)",backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:r?"pointer":"default",boxShadow:"0 4px 16px rgba(0,0,0,0.4)",transition:"right 0.4s ease-in-out, transform 0.4s ease-in-out, all 0.3s ease",border:"3px solid ".concat(b()),pointerEvents:"auto",animation:i||d?"none":l?"pulse-connect 1s ease-in-out infinite":t?"none":"pulse-disconnect 2s ease-in-out infinite",transform:d?"translateX(100px)":"translateX(0)"},onMouseEnter:e=>{l||(e.target.style.transform="scale(1.1)",e.target.style.boxShadow="0 6px 20px rgba(0,0,0,0.5)")},onMouseLeave:e=>{l||(e.target.style.transform="scale(1)",e.target.style.boxShadow="0 4px 16px rgba(0,0,0,0.4)")},title:t?"Connected to server":l?"Connecting to server...":"Connection lost - Click for details",className:"jsx-a7d97ecb79e7aa48",children:(0,o.jsx)(g._8$,{size:28,color:b()})})]})}function p(e){var t,n,a,i;let{maintenance:u,joinCodePress:h,inCrazyGames:p,inCoolMathGames:f,inGame:w,openAccountModal:x,shown:y,backBtnPressed:b,reloadBtnPressed:v,setGameOptionsModalShown:k,onNavbarPress:j,onFriendsPress:C,gameOptions:S,session:A,screen:R,multiplayerState:_,loading:B,gameOptionsModalShown:N,accountModalOpen:T,selectCountryModalShown:I,mapModalOpen:F,onConnectionError:E}=e,{t:M}=(0,s.B)("common"),D=((null==_?void 0:_.inGame)||"singleplayer"===R)&&!B&&!((null==_?void 0:_.inGame)&&(null==_||null==(t=_.gameData)?void 0:t.state)==="waiting"),[z,P]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{window.location.search.includes("app=true")&&P(!1)},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"navbar ".concat(y?"":"hidden"," ").concat("home"==R?"":"navbarColor"," ").concat("onboarding"===R?"onboarding":""),children:[(0,o.jsxs)("div",{className:"nonHome ".concat("home"===R?"":"shown"),children:[!F&&(0,o.jsx)("h1",{className:"navbar__title desktop",onClick:j,children:"WorldGuessr"}),!F&&(0,o.jsx)("h1",{className:"navbar__title mobile",onClick:j,children:"WG"}),!N&&!T&&!I&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{className:"gameBtn navBtn backBtn ".concat("onboarding"===R?"g2_blue_button":"g2_red_button"," desktop"),onClick:b,children:M("onboarding"===R?"menu":"back")}),(0,o.jsx)("button",{className:"gameBtn navBtn backBtn ".concat("onboarding"===R?"g2_blue_button":"g2_red_button"," mobile"),onClick:b,children:(0,o.jsx)(r.QVr,{})})]})]}),D&&!T&&!N&&(0,o.jsx)("button",{className:"gameBtn navBtn backBtn reloadBtn g2_blue_button",onClick:v,children:(0,o.jsx)("img",{src:"/return.png",alt:"reload",height:13,style:{filter:"invert(1)",transform:"scale(1.5)"}})}),(0,o.jsx)(m,{connected:null==_?void 0:_.connected,connecting:null==_?void 0:_.connecting,shown:!0,onClick:(null==_?void 0:_.connected)?void 0:E}),"multiplayer"===R&&(null==_?void 0:_.inGame)&&(null==_||null==(n=_.gameData)?void 0:n.players.length)>0&&(0,o.jsxs)("span",{id:"playerCnt",className:"bigSpan",children:["\xa0 ",(0,o.jsx)(r.x$1,{})," ",_.gameData.players.length]}),(0,o.jsxs)("div",{className:"navbar__right",children:["singleplayer"===R&&!T&&(0,o.jsxs)("button",{className:"gameBtn navBtn g2_green_button g2_lexend",disabled:B,onClick:()=>k(!0),children:["all"!==S.location&&S.location?(null==S?void 0:S.countryMap)?(0,l.A)(S.location):null==S?void 0:S.communityMapName:M("allCountries"),S.nm&&S.npz?", NMPZ":S.nm?", NM":S.npz?", NPZ":"","\xa0",(0,o.jsx)(g.dgZ,{size:20})]}),"onboarding"===R&&(0,o.jsx)("button",{className:"gameBtn navBtn",style:{backgroundColor:"blue"},onClick:h,children:M("joinGame")}),!w&&z&&!f&&!T&&!F&&(0,o.jsx)(d,{inCrazyGames:p,session:A,navbarMode:"home"!==R,openAccountModal:x}),(null==A||null==(a=A.token)?void 0:a.secret)&&!T&&!N&&!F&&!["getready","guess"].includes(null==_||null==(i=_.gameData)?void 0:i.state)&&(0,o.jsx)("button",{className:"gameBtn friendBtn ".concat("home"===R?"friendBtnFixed":""),onClick:C,disabled:!(null==_?void 0:_.connected),children:(0,o.jsx)(r.M5n,{size:40,className:"friendBtnIcon ".concat("home"===R?"friendBtnIconFixed":"")})})]})]})})}},4279:(e,t,n)=>{n.d(t,{A:()=>r});var o=n(7876);function r(e){let{countryCode:t,style:n={},size:r=24}=e;if(!t||""===t||"string"!=typeof t||2!==t.length)return null;let l=t.toLowerCase();return(0,o.jsx)("img",{src:"https://flagcdn.com/w40/".concat(l,".png"),srcSet:"".concat("https://flagcdn.com/w80/".concat(l,".png")," 2x"),alt:t,title:t,style:{display:"inline-block",marginRight:"6px",height:"".concat(r,"px"),width:"auto",verticalAlign:"middle",...n}})}},4679:(e,t,n)=>{n.d(t,{A:()=>l});var o=n(6107);let r={GB:"United Kingdom",US:"United States",RU:"Russia",KR:"South Korea",TW:"Taiwan"};function l(e){var t;return null!=(t=r[e])?t:o.JJ(e)}},6336:(e,t,n)=>{n.d(t,{CI:()=>s,Jv:()=>i,dJ:()=>u,wV:()=>c});var o=n(858),r=n(2446),l=n(8207);let a=!1;function s(){window.localStorage.removeItem("wg_secret"),a=null,window.dontReconnect||(console.log("Removing cookies"),function(){for(var e=document.cookie.split("; "),t=0;t<e.length;t++)for(var n=window.location.hostname.split(".");n.length>0;){var o=encodeURIComponent(e[t].split(";")[0].split("=")[0])+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain="+n.join(".")+" ;path=",r=location.pathname.split("/");for(document.cookie=o+"/";r.length>0;)document.cookie=o+r.join("/"),console.log(o+r.join("/")),r.pop();n.shift()}}(),window.location.reload())}function i(){if(console.log("Signing in"),(0,o.a)()){console.log("In iframe");let e=window.location.href;window.open(e,"_blank")}window.login()}function c(){var e,t;if(window.location.hostname.includes("crazygames")&&window.verifyPayload&&"not_logged_in"===JSON.parse(window.verifyPayload).secret)return{data:null};if(!1===a&&!window.fetchingSession&&(null==(e=window.cConfig)?void 0:e.apiUrl)){let e=null;try{e=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}e?(window.fetchingSession=!0,console.log("[Auth] Starting authentication with retry mechanism"),l.A.fetchWithRetry((null==(t=window.cConfig)?void 0:t.apiUrl)+"/api/googleAuth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:e})},"googleAuth").then(e=>e.json()).then(e=>{if(window.fetchingSession=!1,console.log("[Auth] Authentication successful"),e.error){console.error("[Auth] Server error:",e.error),a=null;return}e.secret?(window.localStorage.setItem("wg_secret",e.secret),a={token:e},console.log("[Auth] Session established for user:",e.username)):(console.log("[Auth] No session data received, user not logged in"),a=null)}).catch(e=>{window.fetchingSession=!1,console.error("[Auth] Authentication failed after all retries:",e.message);try{window.localStorage.removeItem("wg_secret")}catch(e){console.warn("[Auth] Could not clear localStorage:",e)}a=null,l.A.getRetryCount("googleAuth")>=5&&r.oR.error("Connection issues detected. Please refresh the page if problems persist.")})):a=null}return{data:a}}function u(){var e;let t=null;if(a&&(null==a||null==(e=a.token)?void 0:e.secret))t=a.secret;else try{t=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}return t?{Authorization:"Bearer "+t}:{}}},8207:(e,t,n)=>{n.d(t,{A:()=>r});class o{async fetchWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o=this.retryAttempts.get(n)||0;console.log("[RetryFetch] Attempting ".concat(n," (attempt ").concat(o+1,"/").concat(this.maxRetries+1,")"));try{let o=new AbortController,r=setTimeout(()=>o.abort(),1e4),l=await fetch(e,{...t,signal:o.signal});if(clearTimeout(r),!l.ok)throw Error("HTTP ".concat(l.status,": ").concat(l.statusText));return this.retryAttempts.delete(n),console.log("[RetryFetch] Success for ".concat(n)),l}catch(r){if(console.warn("[RetryFetch] Error for ".concat(n,":"),r.message),o<this.maxRetries&&this.shouldRetry(r)){let r=Math.min(this.baseDelay*Math.pow(2,o),this.maxDelay);return console.log("[RetryFetch] Retrying ".concat(n," in ").concat(r,"ms...")),this.retryAttempts.set(n,o+1),new Promise(o=>{setTimeout(()=>{o(this.fetchWithRetry(e,t,n))},r)})}throw console.error("[RetryFetch] Failed ".concat(n," after ").concat(o+1," attempts:"),r.message),this.retryAttempts.delete(n),r}}shouldRetry(e){return"AbortError"===e.name||"TypeError"===e.name||e.message&&e.message.includes("fetch")||e.message&&e.message.includes("HTTP 5")}resetRetries(e){this.retryAttempts.delete(e),console.log("[RetryFetch] Reset retry count for ".concat(e))}getRetryCount(e){return this.retryAttempts.get(e)||0}constructor(){this.retryAttempts=new Map,this.maxRetries=5,this.baseDelay=1e3,this.maxDelay=3e4}}let r=new o}}]);