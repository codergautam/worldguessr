(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{35:(n,e,t)=>{"use strict";t.d(e,{N:()=>a,V:()=>c});var r=t(4232),l=t(5947),o=t(5073),u=t(1567),i=t(8420);function a(n,e){(0,r.useEffect)(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){e.layerContainer?.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function c(n){return function(e){let t=(0,o.U$)(),r=n((0,i.P)(e,t),t);return(0,l.z)(t.map,e.attribution),(0,u.x)(r.current,e.eventHandlers),a(r.current,t),r}}},723:(n,e,t)=>{"use strict";t.d(e,{T:()=>o});var r=t(4232),l=t(5073);function o(n){return function(e){let t=(0,l.U$)(),o=n(e,t),{instance:u}=o.current,i=(0,r.useRef)(e.position),{position:a}=e;return(0,r.useEffect)(function(){return u.addTo(t.map),function(){u.remove()}},[t.map,u]),(0,r.useEffect)(function(){null!=a&&a!==i.current&&(u.setPosition(a),i.current=a)},[u,a]),o}}},1567:(n,e,t)=>{"use strict";t.d(e,{x:()=>l});var r=t(4232);function l(n,e){let t=(0,r.useRef)();(0,r.useEffect)(function(){return null!=e&&n.instance.on(e),t.current=e,function(){null!=t.current&&n.instance.off(t.current),t.current=null}},[n,e])}},1782:()=>{},1937:(n,e,t)=>{"use strict";t.d(e,{m:()=>i});var r=t(4986),l=t(2526),o=t(6895),u=t(4232);let i=(0,r.wk)(function(n,e){let t=new o.Tooltip(n,e.overlayContainer);return(0,l.Q)(t,e)},function(n,e,{position:t},r){(0,u.useEffect)(function(){let l=e.overlayContainer;if(null==l)return;let{instance:o}=n,u=n=>{n.tooltip===o&&(null!=t&&o.setLatLng(t),o.update(),r(!0))},i=n=>{n.tooltip===o&&r(!1)};return l.on({tooltipopen:u,tooltipclose:i}),l.bindTooltip(o),function(){l.off({tooltipopen:u,tooltipclose:i}),null!=l._map&&l.unbindTooltip()}},[n,e,r,t])})},2349:(n,e,t)=>{"use strict";t.d(e,{B7:()=>u,KU:()=>a,jU:()=>i});var r=t(4232),l=t(8477),o=t(5073);function u(n){return(0,r.forwardRef)(function(e,t){let{instance:l,context:u}=n(e).current;return(0,r.useImperativeHandle)(t,()=>l),null==e.children?null:r.createElement(o.hL,{value:u},e.children)})}function i(n){return(0,r.forwardRef)(function(e,t){let[o,u]=(0,r.useState)(!1),{instance:i}=n(e,u).current;(0,r.useImperativeHandle)(t,()=>i),(0,r.useEffect)(function(){o&&i.update()},[i,o,e.children]);let a=i._contentNode;return a?(0,l.createPortal)(e.children,a):null})}function a(n){return(0,r.forwardRef)(function(e,t){let{instance:l}=n(e).current;return(0,r.useImperativeHandle)(t,()=>l),null})}},2526:(n,e,t)=>{"use strict";t.d(e,{K:()=>o,Q:()=>l});var r=t(4232);function l(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function o(n,e){return null==e?function(e,t){let l=(0,r.useRef)();return l.current||(l.current=n(e,t)),l}:function(t,l){let o=(0,r.useRef)();o.current||(o.current=n(t,l));let u=(0,r.useRef)(t),{instance:i}=o.current;return(0,r.useEffect)(function(){u.current!==t&&(e(i,t,u.current),u.current=t)},[i,t,l]),o}}},3138:(n,e,t)=>{"use strict";t.d(e,{Po:()=>i,gY:()=>u,ko:()=>o});var r=t(5073),l=t(4232);function o(){return(0,r.U$)().map}function u(n,e){let t=o();return(0,l.useEffect)(function(){return t.on(n,e),function(){t.off(n,e)}},[t,n,e]),t}function i(n){let e=o();return(0,l.useEffect)(function(){return e.on(n),function(){e.off(n)}},[e,n]),e}},4986:(n,e,t)=>{"use strict";t.d(e,{T7:()=>d,Nq:()=>p,wk:()=>g,Lt:()=>m,X3:()=>v});var r=t(2349),l=t(723),o=t(2526),u=t(35),i=t(5947),a=t(5073),c=t(1567),s=t(8420),f=t(4232);function d(n){let e=(0,o.K)(function(e,t){return(0,o.Q)(n(e),t)}),t=(0,l.T)(e);return(0,r.KU)(t)}function p(n,e){let t=(0,o.K)(n,e),l=(0,u.V)(t);return(0,r.B7)(l)}function g(n,e){var t;let l=(t=(0,o.K)(n),function(n,r){let l=(0,a.U$)(),o=t((0,s.P)(n,l),l);return(0,i.z)(l.map,n.attribution),(0,c.x)(o.current,n.eventHandlers),e(o.current,l,n,r),o});return(0,r.jU)(l)}function m(n,e){var t;let l=(t=(0,o.K)(n,e),function(n){let e=(0,a.U$)(),r=t((0,s.P)(n,e),e);(0,c.x)(r.current,n.eventHandlers),(0,u.N)(r.current,e);var l=r.current;let o=(0,f.useRef)();return(0,f.useEffect)(function(){if(n.pathOptions!==o.current){let e=n.pathOptions??{};l.instance.setStyle(e),o.current=e}},[l,n]),r});return(0,r.B7)(l)}function v(n,e){let t=(0,o.K)(n,e),l=(0,u.V)(t);return(0,r.KU)(l)}},5073:(n,e,t)=>{"use strict";t.d(e,{U$:()=>a,W4:()=>o,fB:()=>l,hL:()=>i});var r=t(4232);function l(n){return Object.freeze({__version:1,map:n})}function o(n,e){return Object.freeze({...n,...e})}let u=(0,r.createContext)(null),i=u.Provider;function a(){let n=(0,r.useContext)(u);if(null==n)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}},5947:(n,e,t)=>{"use strict";t.d(e,{z:()=>l});var r=t(4232);function l(n,e){let t=(0,r.useRef)(e);(0,r.useEffect)(function(){e!==t.current&&null!=n.attributionControl&&(null!=t.current&&n.attributionControl.removeAttribution(t.current),null!=e&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}},6299:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>x});var r=t(7876),l=t(4232),o=t(8847),u=t(3138),i=t(7152),a=t(1937),c=t(6594),s=t(9458),f=t(1173);t(1782);let d=JSON.parse('{"PolandballNik":"polandball"}');var p=t(9395),g=t(5364);let m=o(()=>t.e(651).then(t.bind(t,1032)).then(n=>n.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),v=o(()=>t.e(651).then(t.bind(t,1032)).then(n=>n.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1});function h(n){let{pinPoint:e,setPinPoint:t,answerShown:r,dest:o,gameOptions:i,ws:a,multiplayerState:c,playSound:s}=n,f=l.useRef(c),d=l.useRef(a);(0,l.useEffect)(()=>{f.current=c},[c]),(0,l.useEffect)(()=>{d.current=a},[a]);let p=(0,u.Po)({click(n){var e,l,o;let u=f.current,i=d.current;if(!r&&(!(null==u?void 0:u.inGame)||(null==u?void 0:u.inGame)&&!(null==u||null==(l=u.gameData)||null==(e=l.players.find(n=>{var e;return n.id===(null==u||null==(e=u.gameData)?void 0:e.myId)}))?void 0:e.final))){if(t(n.latlng),(null==u?void 0:u.inGame)&&(null==(o=u.gameData)?void 0:o.state)==="guess"&&i){let e=[n.latlng.lat,n.latlng.lng];i.send(JSON.stringify({type:"place",latLong:e,final:!1}))}let e=L.latLngBounds([-90,-180],[90,180]);e.contains(n.latlng)||n.target.panInsideBounds(e,{animate:!0})}}});(0,l.useEffect)(()=>{let n=null==i?void 0:i.extent;p&&!r&&setTimeout(()=>{try{if(n){let e=L.latLngBounds([n[1],n[0]],[n[3],n[2]]);p.fitBounds(e)}else p.setView([30,0],2)}catch(n){}},500)},[(null==i?void 0:i.extent)?JSON.stringify(i.extent):null,p,r]),(0,l.useEffect)(()=>{e&&setTimeout(()=>{try{let n=L.latLngBounds([e,{lat:o.lat,lng:o.long}]).pad(.5);p.flyToBounds(n,{duration:.5})}catch(n){}},300)},[r]),(0,l.useEffect)(()=>{let n=setInterval(()=>{p.invalidateSize()},5);return()=>clearInterval(n)},[p])}let x=n=>{var e,t,o,u;let{shown:x,options:y,ws:b,session:j,pinPoint:E,setPinPoint:C,answerShown:w,location:O,setKm:z,guessing:R,multiplayerSentGuess:k,multiplayerState:U,showHint:I,round:P,focused:T,gameOptions:B}=n,N=l.useRef(null),S=l.useRef(),{t:A}=(0,f.B)("common"),K=(0,l.useMemo)(()=>({dest:L.icon({iconUrl:"./dest.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src:L.icon({iconUrl:"./src.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src2:L.icon({iconUrl:"./src2.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),polandball:L.icon({iconUrl:"./polandball.png",iconSize:[50,82],iconAnchor:[25,41],popupAnchor:[1,5]})}),[]);(0,l.useEffect)(()=>{if(w&&E&&O){let n=E.distanceTo({lat:O.lat,lng:O.long})/1e3;z(n=n>100?Math.round(n):n>10?parseFloat(n.toFixed(1)):parseFloat(n.toFixed(2)))}},[w,E,O]);let _=L.latLng(-180,-360),H=L.latLng(180,360);return L.latLngBounds(_,H),(0,r.jsxs)(m,{center:[0,0],zoom:2,minZoom:2,style:{height:"100%",width:"100%"},whenCreated:n=>{N.current=n},children:[(0,r.jsx)("div",{className:"mapAttr",children:(0,r.jsx)("img",{width:"60",src:"https://lh3.googleusercontent.com/d_S5gxu_S1P6NR1gXeMthZeBzkrQMHdI5uvXrpn3nfJuXpCjlqhLQKH_hbOxTHxFhp5WugVOEcl4WDrv9rmKBDOMExhKU5KmmLFQVg"})}),(0,r.jsx)(h,{playSound:()=>{S.current.play()},pinPoint:E,setPinPoint:C,answerShown:w,dest:O,gameOptions:B,ws:b,multiplayerState:U}),O&&w&&(0,r.jsx)(i.p,{position:{lat:O.lat,lng:O.long},icon:K.dest}),E&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{position:E,icon:"polandball"===d[null==j||null==(e=j.token)?void 0:e.username]?K.polandball:K.src,children:(0,r.jsx)(a.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:E.lat,lng:E.lng},children:A("yourGuess")})}),w&&O&&(0,r.jsx)(c.R,{positions:[E,{lat:O.lat,lng:O.long}]})]}),(null==U?void 0:U.inGame)&&w&&O&&(null==U||null==(t=U.gameData)?void 0:t.players.map((n,e)=>{var t;if(n.id===(null==U||null==(t=U.gameData)?void 0:t.myId)||!n.guess)return null;let l=g.env.NEXT_PUBLIC_COOLMATH?(0,p.A)(n.username):n.username,o=[n.guess[0],n.guess[1]],u="polandball"===d[l]?K.polandball:K.src2;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.p,{position:{lat:o[0],lng:o[1]},icon:u,children:(0,r.jsx)(a.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:o[0],lng:o[1]},children:(0,r.jsx)("span",{style:{color:"black"},children:l})})},2*e),(0,r.jsx)(c.R,{positions:[{lat:o[0],lng:o[1]},{lat:O.lat,lng:O.long}],color:"green"},2*e+1)]})})),I&&O&&(0,r.jsx)(s.j,{center:{lat:O.lat,lng:O.long},radius:(o=250*(null==B?void 0:B.maxDist),o)}),(0,r.jsx)(v,{noWrap:!0,url:"https://mt{s}.google.com/vt/lyrs=".concat(null!=(u=null==y?void 0:y.mapType)?u:"m","&x={x}&y={y}&z={z}&hl=").concat(A("lang")),subdomains:["0","1","2","3"],attribution:'\xa9 <a href="https://maps.google.com">Google</a>',maxZoom:22,zoomOffset:0}),(0,r.jsx)("audio",{ref:S,src:"/plop.mp3",preload:"auto"})]})}},6594:(n,e,t)=>{"use strict";t.d(e,{R:()=>i});var r=t(4986),l=t(2526),o=t(5073),u=t(6895);let i=(0,r.Lt)(function({positions:n,...e},t){let r=new u.Polyline(n,e);return(0,l.Q)(r,(0,o.W4)(t,{overlayContainer:r}))},function(n,e,t){e.positions!==t.positions&&n.setLatLngs(e.positions)})},7152:(n,e,t)=>{"use strict";t.d(e,{p:()=>i});var r=t(4986),l=t(2526),o=t(5073),u=t(6895);let i=(0,r.Nq)(function({position:n,...e},t){let r=new u.Marker(n,e);return(0,l.Q)(r,(0,o.W4)(t,{overlayContainer:r}))},function(n,e,t){e.position!==t.position&&n.setLatLng(e.position),null!=e.icon&&e.icon!==t.icon&&n.setIcon(e.icon),null!=e.zIndexOffset&&e.zIndexOffset!==t.zIndexOffset&&n.setZIndexOffset(e.zIndexOffset),null!=e.opacity&&e.opacity!==t.opacity&&n.setOpacity(e.opacity),null!=n.dragging&&e.draggable!==t.draggable&&(!0===e.draggable?n.dragging.enable():n.dragging.disable())})},8420:(n,e,t)=>{"use strict";function r(n,e){let t=n.pane??e.pane;return t?{...n,pane:t}:n}t.d(e,{P:()=>r})},9458:(n,e,t)=>{"use strict";t.d(e,{j:()=>a});var r=t(4986),l=t(2526),o=t(5073),u=t(9594),i=t(6895);let a=(0,r.Lt)(function({center:n,children:e,...t},r){let u=new i.Circle(n,t);return(0,l.Q)(u,(0,o.W4)(r,{overlayContainer:u}))},u.s)},9594:(n,e,t)=>{"use strict";function r(n,e,t){e.center!==t.center&&n.setLatLng(e.center),null!=e.radius&&e.radius!==t.radius&&n.setRadius(e.radius)}t.d(e,{s:()=>r})}}]);