(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{35:(n,e,t)=>{"use strict";t.d(e,{N:()=>a,V:()=>c});var r=t(4232),l=t(5947),o=t(5073),i=t(1567),u=t(8420);function a(n,e){(0,r.useEffect)(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){e.layerContainer?.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function c(n){return function(e){let t=(0,o.U$)(),r=n((0,u.P)(e,t),t);return(0,l.z)(t.map,e.attribution),(0,i.x)(r.current,e.eventHandlers),a(r.current,t),r}}},723:(n,e,t)=>{"use strict";t.d(e,{T:()=>o});var r=t(4232),l=t(5073);function o(n){return function(e){let t=(0,l.U$)(),o=n(e,t),{instance:i}=o.current,u=(0,r.useRef)(e.position),{position:a}=e;return(0,r.useEffect)(function(){return i.addTo(t.map),function(){i.remove()}},[t.map,i]),(0,r.useEffect)(function(){null!=a&&a!==u.current&&(i.setPosition(a),u.current=a)},[i,a]),o}}},1567:(n,e,t)=>{"use strict";t.d(e,{x:()=>l});var r=t(4232);function l(n,e){let t=(0,r.useRef)();(0,r.useEffect)(function(){return null!=e&&n.instance.on(e),t.current=e,function(){null!=t.current&&n.instance.off(t.current),t.current=null}},[n,e])}},1782:()=>{},1937:(n,e,t)=>{"use strict";t.d(e,{m:()=>u});var r=t(4986),l=t(2526),o=t(2133),i=t(4232);let u=(0,r.wk)(function(n,e){let t=new o.Tooltip(n,e.overlayContainer);return(0,l.Q)(t,e)},function(n,e,{position:t},r){(0,i.useEffect)(function(){let l=e.overlayContainer;if(null==l)return;let{instance:o}=n,i=n=>{n.tooltip===o&&(null!=t&&o.setLatLng(t),o.update(),r(!0))},u=n=>{n.tooltip===o&&r(!1)};return l.on({tooltipopen:i,tooltipclose:u}),l.bindTooltip(o),function(){l.off({tooltipopen:i,tooltipclose:u}),null!=l._map&&l.unbindTooltip()}},[n,e,r,t])})},2349:(n,e,t)=>{"use strict";t.d(e,{B7:()=>i,KU:()=>a,jU:()=>u});var r=t(4232),l=t(8477),o=t(5073);function i(n){return(0,r.forwardRef)(function(e,t){let{instance:l,context:i}=n(e).current;return(0,r.useImperativeHandle)(t,()=>l),null==e.children?null:r.createElement(o.hL,{value:i},e.children)})}function u(n){return(0,r.forwardRef)(function(e,t){let[o,i]=(0,r.useState)(!1),{instance:u}=n(e,i).current;(0,r.useImperativeHandle)(t,()=>u),(0,r.useEffect)(function(){o&&u.update()},[u,o,e.children]);let a=u._contentNode;return a?(0,l.createPortal)(e.children,a):null})}function a(n){return(0,r.forwardRef)(function(e,t){let{instance:l}=n(e).current;return(0,r.useImperativeHandle)(t,()=>l),null})}},2526:(n,e,t)=>{"use strict";t.d(e,{K:()=>o,Q:()=>l});var r=t(4232);function l(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function o(n,e){return null==e?function(e,t){let l=(0,r.useRef)();return l.current||(l.current=n(e,t)),l}:function(t,l){let o=(0,r.useRef)();o.current||(o.current=n(t,l));let i=(0,r.useRef)(t),{instance:u}=o.current;return(0,r.useEffect)(function(){i.current!==t&&(e(u,t,i.current),i.current=t)},[u,t,l]),o}}},3138:(n,e,t)=>{"use strict";t.d(e,{Po:()=>u,gY:()=>i,ko:()=>o});var r=t(5073),l=t(4232);function o(){return(0,r.U$)().map}function i(n,e){let t=o();return(0,l.useEffect)(function(){return t.on(n,e),function(){t.off(n,e)}},[t,n,e]),t}function u(n){let e=o();return(0,l.useEffect)(function(){return e.on(n),function(){e.off(n)}},[e,n]),e}},4986:(n,e,t)=>{"use strict";t.d(e,{T7:()=>d,Nq:()=>p,wk:()=>g,Lt:()=>m,X3:()=>v});var r=t(2349),l=t(723),o=t(2526),i=t(35),u=t(5947),a=t(5073),c=t(1567),s=t(8420),f=t(4232);function d(n){let e=(0,o.K)(function(e,t){return(0,o.Q)(n(e),t)}),t=(0,l.T)(e);return(0,r.KU)(t)}function p(n,e){let t=(0,o.K)(n,e),l=(0,i.V)(t);return(0,r.B7)(l)}function g(n,e){var t;let l=(t=(0,o.K)(n),function(n,r){let l=(0,a.U$)(),o=t((0,s.P)(n,l),l);return(0,u.z)(l.map,n.attribution),(0,c.x)(o.current,n.eventHandlers),e(o.current,l,n,r),o});return(0,r.jU)(l)}function m(n,e){var t;let l=(t=(0,o.K)(n,e),function(n){let e=(0,a.U$)(),r=t((0,s.P)(n,e),e);(0,c.x)(r.current,n.eventHandlers),(0,i.N)(r.current,e);var l=r.current;let o=(0,f.useRef)();return(0,f.useEffect)(function(){if(n.pathOptions!==o.current){let e=n.pathOptions??{};l.instance.setStyle(e),o.current=e}},[l,n]),r});return(0,r.B7)(l)}function v(n,e){let t=(0,o.K)(n,e),l=(0,i.V)(t);return(0,r.KU)(l)}},5073:(n,e,t)=>{"use strict";t.d(e,{U$:()=>a,W4:()=>o,fB:()=>l,hL:()=>u});var r=t(4232);function l(n){return Object.freeze({__version:1,map:n})}function o(n,e){return Object.freeze({...n,...e})}let i=(0,r.createContext)(null),u=i.Provider;function a(){let n=(0,r.useContext)(i);if(null==n)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}},5947:(n,e,t)=>{"use strict";t.d(e,{z:()=>l});var r=t(4232);function l(n,e){let t=(0,r.useRef)(e);(0,r.useEffect)(function(){e!==t.current&&null!=n.attributionControl&&(null!=t.current&&n.attributionControl.removeAttribution(t.current),null!=e&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}},6299:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>h});var r=t(7876),l=t(4232),o=t(8847),i=t(3138),u=t(7152),a=t(1937),c=t(6594),s=t(9458),f=t(1173);t(1782);let d=JSON.parse('{"PolandballNik":"polandball"}');var p=t(9395);let g=o(()=>t.e(651).then(t.bind(t,1032)).then(n=>n.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),m=o(()=>t.e(651).then(t.bind(t,1032)).then(n=>n.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1});function v(n){let{pinPoint:e,setPinPoint:t,answerShown:r,dest:o,gameOptions:u,ws:a,multiplayerState:c,playSound:s}=n,f=l.useRef(c),d=l.useRef(a);(0,l.useEffect)(()=>{f.current=c},[c]),(0,l.useEffect)(()=>{d.current=a},[a]);let p=(0,i.Po)({click(n){var e,l,o;let i=f.current,u=d.current;if(!r&&(!(null==i?void 0:i.inGame)||(null==i?void 0:i.inGame)&&!(null==i||null==(l=i.gameData)||null==(e=l.players.find(n=>{var e;return n.id===(null==i||null==(e=i.gameData)?void 0:e.myId)}))?void 0:e.final))){if(t(n.latlng),(null==i?void 0:i.inGame)&&(null==(o=i.gameData)?void 0:o.state)==="guess"&&u){let e=[n.latlng.lat,n.latlng.lng];u.send(JSON.stringify({type:"place",latLong:e,final:!1}))}let e=L.latLngBounds([-90,-180],[90,180]);e.contains(n.latlng)||n.target.panInsideBounds(e,{animate:!0})}}});(0,l.useEffect)(()=>{let n=null==u?void 0:u.extent;p&&!r&&setTimeout(()=>{try{if(n){let e=L.latLngBounds([n[1],n[0]],[n[3],n[2]]);p.fitBounds(e)}else p.setView([30,0],2)}catch(n){}},500)},[(null==u?void 0:u.extent)?JSON.stringify(u.extent):null,p,r]),(0,l.useEffect)(()=>{e&&setTimeout(()=>{try{let n=L.latLngBounds([e,{lat:o.lat,lng:o.long}]).pad(.5);p.flyToBounds(n,{duration:.5})}catch(n){}},300)},[r]),(0,l.useEffect)(()=>{let n=setInterval(()=>{p.invalidateSize()},5);return()=>clearInterval(n)},[p])}let h=n=>{var e,t,o,i;let{shown:h,options:x,ws:y,session:b,pinPoint:w,setPinPoint:E,answerShown:j,location:z,setKm:C,guessing:R,multiplayerSentGuess:k,multiplayerState:O,showHint:P,round:S,focused:U,gameOptions:I}=n,T=l.useRef(null),B=l.useRef(),[N,K]=(0,l.useState)(!1),{t:A}=(0,f.B)("common");(0,l.useEffect)(()=>{let n=()=>{let n="ontouchstart"in window||navigator.maxTouchPoints>0,e=window.innerWidth<=1024;K(n||e)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);let _=(0,l.useMemo)(()=>({dest:L.icon({iconUrl:"./dest.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src:L.icon({iconUrl:"./src.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src2:L.icon({iconUrl:"./src2.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),polandball:L.icon({iconUrl:"./polandball.png",iconSize:[50,82],iconAnchor:[25,41],popupAnchor:[1,5]})}),[]);(0,l.useEffect)(()=>{if(j&&w&&z){let n=w.distanceTo({lat:z.lat,lng:z.long})/1e3;C(n=n>100?Math.round(n):n>10?parseFloat(n.toFixed(1)):parseFloat(n.toFixed(2)))}},[j,w,z]);let W=L.latLng(-180,-360),H=L.latLng(180,360);return L.latLngBounds(W,H),(0,r.jsxs)(g,{center:[0,0],zoom:2,minZoom:2,style:{height:"100%",width:"100%"},whenCreated:n=>{T.current=n},children:[(0,r.jsx)("div",{className:"mapAttr",children:(0,r.jsx)("img",{width:"60",src:"https://lh3.googleusercontent.com/d_S5gxu_S1P6NR1gXeMthZeBzkrQMHdI5uvXrpn3nfJuXpCjlqhLQKH_hbOxTHxFhp5WugVOEcl4WDrv9rmKBDOMExhKU5KmmLFQVg"})}),(0,r.jsx)(v,{playSound:()=>{B.current.play()},pinPoint:w,setPinPoint:E,answerShown:j,dest:z,gameOptions:I,ws:y,multiplayerState:O}),z&&j&&(0,r.jsx)(u.p,{position:{lat:z.lat,lng:z.long},icon:_.dest}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.p,{position:w,icon:"polandball"===d[null==b||null==(e=b.token)?void 0:e.username]?_.polandball:_.src,children:(0,r.jsx)(a.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:w.lat,lng:w.lng},children:A("yourGuess")})}),j&&z&&(0,r.jsx)(c.R,{positions:[w,{lat:z.lat,lng:z.long}]})]}),(null==O?void 0:O.inGame)&&j&&z&&(null==O||null==(t=O.gameData)?void 0:t.players.map((n,e)=>{var t;if(n.id===(null==O||null==(t=O.gameData)?void 0:t.myId)||!n.guess)return null;let l=(0,p.A)(n.username),o=[n.guess[0],n.guess[1]],i="polandball"===d[l]?_.polandball:_.src2;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.p,{position:{lat:o[0],lng:o[1]},icon:i,children:(0,r.jsx)(a.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:o[0],lng:o[1]},children:(0,r.jsx)("span",{style:{color:"black"},children:l})})},2*e),(0,r.jsx)(c.R,{positions:[{lat:o[0],lng:o[1]},{lat:z.lat,lng:z.long}],color:"green"},2*e+1)]})})),P&&z&&(0,r.jsx)(s.j,{center:{lat:z.lat,lng:z.long},radius:(o=250*(null==I?void 0:I.maxDist),o)}),(0,r.jsx)(m,{noWrap:!0,url:"https://mt{s}.google.com/vt/lyrs=".concat(null!=(i=null==x?void 0:x.mapType)?i:"m","&x={x}&y={y}&z={z}&hl=").concat(A("lang"),"&scale=2"),subdomains:["0","1","2","3"],attribution:'\xa9 <a href="https://maps.google.com">Google</a>',maxZoom:22},N?"mobile":"desktop"),(0,r.jsx)("audio",{ref:B,src:"/plop.mp3",preload:"auto"})]})}},6594:(n,e,t)=>{"use strict";t.d(e,{R:()=>u});var r=t(4986),l=t(2526),o=t(5073),i=t(2133);let u=(0,r.Lt)(function({positions:n,...e},t){let r=new i.Polyline(n,e);return(0,l.Q)(r,(0,o.W4)(t,{overlayContainer:r}))},function(n,e,t){e.positions!==t.positions&&n.setLatLngs(e.positions)})},7152:(n,e,t)=>{"use strict";t.d(e,{p:()=>u});var r=t(4986),l=t(2526),o=t(5073),i=t(2133);let u=(0,r.Nq)(function({position:n,...e},t){let r=new i.Marker(n,e);return(0,l.Q)(r,(0,o.W4)(t,{overlayContainer:r}))},function(n,e,t){e.position!==t.position&&n.setLatLng(e.position),null!=e.icon&&e.icon!==t.icon&&n.setIcon(e.icon),null!=e.zIndexOffset&&e.zIndexOffset!==t.zIndexOffset&&n.setZIndexOffset(e.zIndexOffset),null!=e.opacity&&e.opacity!==t.opacity&&n.setOpacity(e.opacity),null!=n.dragging&&e.draggable!==t.draggable&&(!0===e.draggable?n.dragging.enable():n.dragging.disable())})},8420:(n,e,t)=>{"use strict";function r(n,e){let t=n.pane??e.pane;return t?{...n,pane:t}:n}t.d(e,{P:()=>r})},9458:(n,e,t)=>{"use strict";t.d(e,{j:()=>a});var r=t(4986),l=t(2526),o=t(5073),i=t(9594),u=t(2133);let a=(0,r.Lt)(function({center:n,children:e,...t},r){let i=new u.Circle(n,t);return(0,l.Q)(i,(0,o.W4)(r,{overlayContainer:i}))},i.s)},9594:(n,e,t)=>{"use strict";function r(n,e,t){e.center!==t.center&&n.setLatLng(e.center),null!=e.radius&&e.radius!==t.radius&&n.setRadius(e.radius)}t.d(e,{s:()=>r})}}]);