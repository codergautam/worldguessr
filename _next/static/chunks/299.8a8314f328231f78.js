(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{35:(n,t,e)=>{"use strict";e.d(t,{N:()=>a,V:()=>c});var r=e(4232),o=e(5947),l=e(5073),i=e(1567),u=e(8420);function a(n,t){(0,r.useEffect)(function(){return(t.layerContainer??t.map).addLayer(n.instance),function(){t.layerContainer?.removeLayer(n.instance),t.map.removeLayer(n.instance)}},[t,n])}function c(n){return function(t){let e=(0,l.U$)(),r=n((0,u.P)(t,e),e);return(0,o.z)(e.map,t.attribution),(0,i.x)(r.current,t.eventHandlers),a(r.current,e),r}}},723:(n,t,e)=>{"use strict";e.d(t,{T:()=>l});var r=e(4232),o=e(5073);function l(n){return function(t){let e=(0,o.U$)(),l=n(t,e),{instance:i}=l.current,u=(0,r.useRef)(t.position),{position:a}=t;return(0,r.useEffect)(function(){return i.addTo(e.map),function(){i.remove()}},[e.map,i]),(0,r.useEffect)(function(){null!=a&&a!==u.current&&(i.setPosition(a),u.current=a)},[i,a]),l}}},1567:(n,t,e)=>{"use strict";e.d(t,{x:()=>o});var r=e(4232);function o(n,t){let e=(0,r.useRef)();(0,r.useEffect)(function(){return null!=t&&n.instance.on(t),e.current=t,function(){null!=e.current&&n.instance.off(e.current),e.current=null}},[n,t])}},1782:()=>{},1937:(n,t,e)=>{"use strict";e.d(t,{m:()=>u});var r=e(4986),o=e(2526),l=e(2133),i=e(4232);let u=(0,r.wk)(function(n,t){let e=new l.Tooltip(n,t.overlayContainer);return(0,o.Q)(e,t)},function(n,t,{position:e},r){(0,i.useEffect)(function(){let o=t.overlayContainer;if(null==o)return;let{instance:l}=n,i=n=>{n.tooltip===l&&(null!=e&&l.setLatLng(e),l.update(),r(!0))},u=n=>{n.tooltip===l&&r(!1)};return o.on({tooltipopen:i,tooltipclose:u}),o.bindTooltip(l),function(){o.off({tooltipopen:i,tooltipclose:u}),null!=o._map&&o.unbindTooltip()}},[n,t,r,e])})},2349:(n,t,e)=>{"use strict";e.d(t,{B7:()=>i,KU:()=>a,jU:()=>u});var r=e(4232),o=e(8477),l=e(5073);function i(n){return(0,r.forwardRef)(function(t,e){let{instance:o,context:i}=n(t).current;return(0,r.useImperativeHandle)(e,()=>o),null==t.children?null:r.createElement(l.hL,{value:i},t.children)})}function u(n){return(0,r.forwardRef)(function(t,e){let[l,i]=(0,r.useState)(!1),{instance:u}=n(t,i).current;(0,r.useImperativeHandle)(e,()=>u),(0,r.useEffect)(function(){l&&u.update()},[u,l,t.children]);let a=u._contentNode;return a?(0,o.createPortal)(t.children,a):null})}function a(n){return(0,r.forwardRef)(function(t,e){let{instance:o}=n(t).current;return(0,r.useImperativeHandle)(e,()=>o),null})}},2526:(n,t,e)=>{"use strict";e.d(t,{K:()=>l,Q:()=>o});var r=e(4232);function o(n,t,e){return Object.freeze({instance:n,context:t,container:e})}function l(n,t){return null==t?function(t,e){let o=(0,r.useRef)();return o.current||(o.current=n(t,e)),o}:function(e,o){let l=(0,r.useRef)();l.current||(l.current=n(e,o));let i=(0,r.useRef)(e),{instance:u}=l.current;return(0,r.useEffect)(function(){i.current!==e&&(t(u,e,i.current),i.current=e)},[u,e,o]),l}}},3138:(n,t,e)=>{"use strict";e.d(t,{Po:()=>u,gY:()=>i,ko:()=>l});var r=e(5073),o=e(4232);function l(){return(0,r.U$)().map}function i(n,t){let e=l();return(0,o.useEffect)(function(){return e.on(n,t),function(){e.off(n,t)}},[e,n,t]),e}function u(n){let t=l();return(0,o.useEffect)(function(){return t.on(n),function(){t.off(n)}},[t,n]),t}},4986:(n,t,e)=>{"use strict";e.d(t,{T7:()=>d,Nq:()=>p,wk:()=>g,Lt:()=>m,X3:()=>h});var r=e(2349),o=e(723),l=e(2526),i=e(35),u=e(5947),a=e(5073),c=e(1567),s=e(8420),f=e(4232);function d(n){let t=(0,l.K)(function(t,e){return(0,l.Q)(n(t),e)}),e=(0,o.T)(t);return(0,r.KU)(e)}function p(n,t){let e=(0,l.K)(n,t),o=(0,i.V)(e);return(0,r.B7)(o)}function g(n,t){var e;let o=(e=(0,l.K)(n),function(n,r){let o=(0,a.U$)(),l=e((0,s.P)(n,o),o);return(0,u.z)(o.map,n.attribution),(0,c.x)(l.current,n.eventHandlers),t(l.current,o,n,r),l});return(0,r.jU)(o)}function m(n,t){var e;let o=(e=(0,l.K)(n,t),function(n){let t=(0,a.U$)(),r=e((0,s.P)(n,t),t);(0,c.x)(r.current,n.eventHandlers),(0,i.N)(r.current,t);var o=r.current;let l=(0,f.useRef)();return(0,f.useEffect)(function(){if(n.pathOptions!==l.current){let t=n.pathOptions??{};o.instance.setStyle(t),l.current=t}},[o,n]),r});return(0,r.B7)(o)}function h(n,t){let e=(0,l.K)(n,t),o=(0,i.V)(e);return(0,r.KU)(o)}},5073:(n,t,e)=>{"use strict";e.d(t,{U$:()=>a,W4:()=>l,fB:()=>o,hL:()=>u});var r=e(4232);function o(n){return Object.freeze({__version:1,map:n})}function l(n,t){return Object.freeze({...n,...t})}let i=(0,r.createContext)(null),u=i.Provider;function a(){let n=(0,r.useContext)(i);if(null==n)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}},5947:(n,t,e)=>{"use strict";e.d(t,{z:()=>o});var r=e(4232);function o(n,t){let e=(0,r.useRef)(t);(0,r.useEffect)(function(){t!==e.current&&null!=n.attributionControl&&(null!=e.current&&n.attributionControl.removeAttribution(e.current),null!=t&&n.attributionControl.addAttribution(t)),e.current=t},[n,t])}},6299:(n,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>b});var r=e(7876),o=e(4232),l=e(8847),i=e(3138),u=e(6724),a=e(7152),c=e(1937),s=e(6594),f=e(1173);e(1782);let d=JSON.parse('{"PolandballNik":"polandball"}');var p=e(9395),g=e(4279);function m(n){let t=1e4*Math.sin(9999*n);return t-Math.floor(t)}function h(n){let{location:t,gameOptions:e,round:l}=n,[a,c]=(0,o.useState)(2),s=(0,i.Po)({zoom:()=>c(s.getZoom())}),f=75*Math.pow(2,a-1),d=(null!=l?l:1)+Math.abs(75*t.lat+75*t.long),p=2*m(3*d)*Math.PI,g=Math.sqrt(m(7*d))*f,h=g*Math.cos(p),v=g*Math.sin(p),x=s.latLngToContainerPoint(L.latLng(t.lat,t.long)),y=L.point(x.x+h,x.y+v),b=s.containerPointToLatLng(y);return(0,r.jsx)(u.p,{center:b,radius:f,className:"hintCircle"})}let v=l(()=>e.e(572).then(e.bind(e,7191)).then(n=>n.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),x=l(()=>e.e(572).then(e.bind(e,7191)).then(n=>n.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1});function y(n){let{pinPoint:t,setPinPoint:e,answerShown:r,dest:l,gameOptions:u,ws:a,multiplayerState:c,playSound:s}=n,f=o.useRef(c),d=o.useRef(a);(0,o.useEffect)(()=>{f.current=c},[c]),(0,o.useEffect)(()=>{d.current=a},[a]);let p=(0,i.Po)({click(n){var t,o,l;let i=f.current,u=d.current;if(!r&&(!(null==i?void 0:i.inGame)||(null==i?void 0:i.inGame)&&!(null==i||null==(o=i.gameData)||null==(t=o.players.find(n=>{var t;return n.id===(null==i||null==(t=i.gameData)?void 0:t.myId)}))?void 0:t.final))){if(e(n.latlng),(null==i?void 0:i.inGame)&&(null==(l=i.gameData)?void 0:l.state)==="guess"&&u){let t=[n.latlng.lat,n.latlng.lng];u.send(JSON.stringify({type:"place",latLong:t,final:!1}))}let t=L.latLngBounds([-90,-180],[90,180]);t.contains(n.latlng)||n.target.panInsideBounds(t,{animate:!0})}}});(0,o.useEffect)(()=>{let n=null==u?void 0:u.extent;p&&!r&&setTimeout(()=>{try{if(n){let t=L.latLngBounds([n[1],n[0]],[n[3],n[2]]);p.fitBounds(t)}else p.setView([30,0],2)}catch(n){}},500)},[(null==u?void 0:u.extent)?JSON.stringify(u.extent):null,p,r]),(0,o.useEffect)(()=>{t&&setTimeout(()=>{try{let n=L.latLngBounds([t,{lat:l.lat,lng:l.long}]).pad(.5);p.flyToBounds(n,{duration:.5})}catch(n){}},300)},[r]),(0,o.useEffect)(()=>{let n=setInterval(()=>{p.invalidateSize()},5);return()=>clearInterval(n)},[p])}let b=n=>{var t,e,l;let{shown:i,options:u,ws:m,session:b,pinPoint:w,setPinPoint:E,answerShown:j,location:C,setKm:z,guessing:P,multiplayerSentGuess:R,multiplayerState:k,showHint:O,round:S,focused:I,gameOptions:M}=n,T=o.useRef(null),U=o.useRef(),[N,B]=(0,o.useState)(!1),{t:A}=(0,f.B)("common");(0,o.useEffect)(()=>{let n=()=>{let n="ontouchstart"in window||navigator.maxTouchPoints>0,t=window.innerWidth<=1024;B(n||t)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);let K=(0,o.useMemo)(()=>({dest:L.icon({iconUrl:"./dest.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src:L.icon({iconUrl:"./src.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src2:L.icon({iconUrl:"./src2.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),polandball:L.icon({iconUrl:"./polandball.png",iconSize:[50,82],iconAnchor:[25,41],popupAnchor:[1,5]})}),[]);(0,o.useEffect)(()=>{if(j&&w&&C){let n=w.distanceTo({lat:C.lat,lng:C.long})/1e3;z(n=n>100?Math.round(n):n>10?parseFloat(n.toFixed(1)):parseFloat(n.toFixed(2)))}},[j,w,C]);let _=L.latLng(-180,-360),W=L.latLng(180,360);return L.latLngBounds(_,W),(0,r.jsxs)(v,{center:[0,0],zoom:2,minZoom:2,style:{height:"100%",width:"100%"},whenCreated:n=>{T.current=n},children:[(0,r.jsx)("div",{className:"mapAttr",children:(0,r.jsx)("img",{width:"60",src:"https://lh3.googleusercontent.com/d_S5gxu_S1P6NR1gXeMthZeBzkrQMHdI5uvXrpn3nfJuXpCjlqhLQKH_hbOxTHxFhp5WugVOEcl4WDrv9rmKBDOMExhKU5KmmLFQVg"})}),(0,r.jsx)(y,{playSound:()=>{U.current.play()},pinPoint:w,setPinPoint:E,answerShown:j,dest:C,gameOptions:M,ws:m,multiplayerState:k}),C&&j&&(0,r.jsx)(a.p,{position:{lat:C.lat,lng:C.long},icon:K.dest}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{position:w,icon:"polandball"===d[null==b||null==(t=b.token)?void 0:t.username]?K.polandball:K.src,children:(0,r.jsx)(c.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:w.lat,lng:w.lng},children:A("yourGuess")})}),j&&C&&(0,r.jsx)(s.R,{positions:[w,{lat:C.lat,lng:C.long}]})]}),(null==k?void 0:k.inGame)&&j&&C&&(null==k||null==(e=k.gameData)?void 0:e.players.map((n,t)=>{var e;if(n.id===(null==k||null==(e=k.gameData)?void 0:e.myId)||!n.guess)return null;let o=(0,p.A)(n.username),l=[n.guess[0],n.guess[1]],i="polandball"===d[o]?K.polandball:K.src2;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{position:{lat:l[0],lng:l[1]},icon:i,children:(0,r.jsx)(c.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:l[0],lng:l[1]},children:(0,r.jsxs)("span",{style:{color:"black",display:"flex",alignItems:"center",gap:"4px"},children:[o,n.countryCode&&(0,r.jsx)(g.A,{countryCode:n.countryCode,style:{fontSize:"0.9em",marginRight:"0"}})]})})},2*t),(0,r.jsx)(s.R,{positions:[{lat:l[0],lng:l[1]},{lat:C.lat,lng:C.long}],color:"green"},2*t+1)]})})),O&&C&&(0,r.jsx)(h,{location:C,gameOptions:M,round:S}),(0,r.jsx)(x,{noWrap:!0,url:"https://mt{s}.google.com/vt/lyrs=".concat(null!=(l=null==u?void 0:u.mapType)?l:"m","&x={x}&y={y}&z={z}&hl=").concat(A("lang"),"&scale=2"),subdomains:["0","1","2","3"],attribution:'\xa9 <a href="https://maps.google.com">Google</a>',maxZoom:22},N?"mobile":"desktop"),(0,r.jsx)("audio",{ref:U,src:"/plop.mp3",preload:"auto"})]})}},6594:(n,t,e)=>{"use strict";e.d(t,{R:()=>u});var r=e(4986),o=e(2526),l=e(5073),i=e(2133);let u=(0,r.Lt)(function({positions:n,...t},e){let r=new i.Polyline(n,t);return(0,o.Q)(r,(0,l.W4)(e,{overlayContainer:r}))},function(n,t,e){t.positions!==e.positions&&n.setLatLngs(t.positions)})},6724:(n,t,e)=>{"use strict";e.d(t,{p:()=>a});var r=e(4986),o=e(2526),l=e(5073),i=e(9594),u=e(2133);let a=(0,r.Lt)(function({center:n,children:t,...e},r){let i=new u.CircleMarker(n,e);return(0,o.Q)(i,(0,l.W4)(r,{overlayContainer:i}))},i.s)},7152:(n,t,e)=>{"use strict";e.d(t,{p:()=>u});var r=e(4986),o=e(2526),l=e(5073),i=e(2133);let u=(0,r.Nq)(function({position:n,...t},e){let r=new i.Marker(n,t);return(0,o.Q)(r,(0,l.W4)(e,{overlayContainer:r}))},function(n,t,e){t.position!==e.position&&n.setLatLng(t.position),null!=t.icon&&t.icon!==e.icon&&n.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==e.zIndexOffset&&n.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==e.opacity&&n.setOpacity(t.opacity),null!=n.dragging&&t.draggable!==e.draggable&&(!0===t.draggable?n.dragging.enable():n.dragging.disable())})},8420:(n,t,e)=>{"use strict";function r(n,t){let e=n.pane??t.pane;return e?{...n,pane:e}:n}e.d(t,{P:()=>r})},9594:(n,t,e)=>{"use strict";function r(n,t,e){t.center!==e.center&&n.setLatLng(t.center),null!=t.radius&&t.radius!==e.radius&&n.setRadius(t.radius)}e.d(t,{s:()=>r})}}]);