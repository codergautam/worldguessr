(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{35:(t,n,e)=>{"use strict";e.d(n,{N:()=>a,V:()=>c});var r=e(4232),o=e(5947),l=e(5073),i=e(1567),u=e(8420);function a(t,n){(0,r.useEffect)(function(){return(n.layerContainer??n.map).addLayer(t.instance),function(){n.layerContainer?.removeLayer(t.instance),n.map.removeLayer(t.instance)}},[n,t])}function c(t){return function(n){let e=(0,l.U$)(),r=t((0,u.P)(n,e),e);return(0,o.z)(e.map,n.attribution),(0,i.x)(r.current,n.eventHandlers),a(r.current,e),r}}},723:(t,n,e)=>{"use strict";e.d(n,{T:()=>l});var r=e(4232),o=e(5073);function l(t){return function(n){let e=(0,o.U$)(),l=t(n,e),{instance:i}=l.current,u=(0,r.useRef)(n.position),{position:a}=n;return(0,r.useEffect)(function(){return i.addTo(e.map),function(){i.remove()}},[e.map,i]),(0,r.useEffect)(function(){null!=a&&a!==u.current&&(i.setPosition(a),u.current=a)},[i,a]),l}}},1567:(t,n,e)=>{"use strict";e.d(n,{x:()=>o});var r=e(4232);function o(t,n){let e=(0,r.useRef)();(0,r.useEffect)(function(){return null!=n&&t.instance.on(n),e.current=n,function(){null!=e.current&&t.instance.off(e.current),e.current=null}},[t,n])}},1782:()=>{},1937:(t,n,e)=>{"use strict";e.d(n,{m:()=>u});var r=e(4986),o=e(2526),l=e(2133),i=e(4232);let u=(0,r.wk)(function(t,n){let e=new l.Tooltip(t,n.overlayContainer);return(0,o.Q)(e,n)},function(t,n,{position:e},r){(0,i.useEffect)(function(){let o=n.overlayContainer;if(null==o)return;let{instance:l}=t,i=t=>{t.tooltip===l&&(null!=e&&l.setLatLng(e),l.update(),r(!0))},u=t=>{t.tooltip===l&&r(!1)};return o.on({tooltipopen:i,tooltipclose:u}),o.bindTooltip(l),function(){o.off({tooltipopen:i,tooltipclose:u}),null!=o._map&&o.unbindTooltip()}},[t,n,r,e])})},2349:(t,n,e)=>{"use strict";e.d(n,{B7:()=>i,KU:()=>a,jU:()=>u});var r=e(4232),o=e(8477),l=e(5073);function i(t){return(0,r.forwardRef)(function(n,e){let{instance:o,context:i}=t(n).current;return(0,r.useImperativeHandle)(e,()=>o),null==n.children?null:r.createElement(l.hL,{value:i},n.children)})}function u(t){return(0,r.forwardRef)(function(n,e){let[l,i]=(0,r.useState)(!1),{instance:u}=t(n,i).current;(0,r.useImperativeHandle)(e,()=>u),(0,r.useEffect)(function(){l&&u.update()},[u,l,n.children]);let a=u._contentNode;return a?(0,o.createPortal)(n.children,a):null})}function a(t){return(0,r.forwardRef)(function(n,e){let{instance:o}=t(n).current;return(0,r.useImperativeHandle)(e,()=>o),null})}},2526:(t,n,e)=>{"use strict";e.d(n,{K:()=>l,Q:()=>o});var r=e(4232);function o(t,n,e){return Object.freeze({instance:t,context:n,container:e})}function l(t,n){return null==n?function(n,e){let o=(0,r.useRef)();return o.current||(o.current=t(n,e)),o}:function(e,o){let l=(0,r.useRef)();l.current||(l.current=t(e,o));let i=(0,r.useRef)(e),{instance:u}=l.current;return(0,r.useEffect)(function(){i.current!==e&&(n(u,e,i.current),i.current=e)},[u,e,o]),l}}},3138:(t,n,e)=>{"use strict";e.d(n,{Po:()=>u,gY:()=>i,ko:()=>l});var r=e(5073),o=e(4232);function l(){return(0,r.U$)().map}function i(t,n){let e=l();return(0,o.useEffect)(function(){return e.on(t,n),function(){e.off(t,n)}},[e,t,n]),e}function u(t){let n=l();return(0,o.useEffect)(function(){return n.on(t),function(){n.off(t)}},[n,t]),n}},4986:(t,n,e)=>{"use strict";e.d(n,{T7:()=>d,Nq:()=>p,wk:()=>g,Lt:()=>m,X3:()=>h});var r=e(2349),o=e(723),l=e(2526),i=e(35),u=e(5947),a=e(5073),c=e(1567),s=e(8420),f=e(4232);function d(t){let n=(0,l.K)(function(n,e){return(0,l.Q)(t(n),e)}),e=(0,o.T)(n);return(0,r.KU)(e)}function p(t,n){let e=(0,l.K)(t,n),o=(0,i.V)(e);return(0,r.B7)(o)}function g(t,n){var e;let o=(e=(0,l.K)(t),function(t,r){let o=(0,a.U$)(),l=e((0,s.P)(t,o),o);return(0,u.z)(o.map,t.attribution),(0,c.x)(l.current,t.eventHandlers),n(l.current,o,t,r),l});return(0,r.jU)(o)}function m(t,n){var e;let o=(e=(0,l.K)(t,n),function(t){let n=(0,a.U$)(),r=e((0,s.P)(t,n),n);(0,c.x)(r.current,t.eventHandlers),(0,i.N)(r.current,n);var o=r.current;let l=(0,f.useRef)();return(0,f.useEffect)(function(){if(t.pathOptions!==l.current){let n=t.pathOptions??{};o.instance.setStyle(n),l.current=n}},[o,t]),r});return(0,r.B7)(o)}function h(t,n){let e=(0,l.K)(t,n),o=(0,i.V)(e);return(0,r.KU)(o)}},5073:(t,n,e)=>{"use strict";e.d(n,{U$:()=>a,W4:()=>l,fB:()=>o,hL:()=>u});var r=e(4232);function o(t){return Object.freeze({__version:1,map:t})}function l(t,n){return Object.freeze({...t,...n})}let i=(0,r.createContext)(null),u=i.Provider;function a(){let t=(0,r.useContext)(i);if(null==t)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}},5947:(t,n,e)=>{"use strict";e.d(n,{z:()=>o});var r=e(4232);function o(t,n){let e=(0,r.useRef)(n);(0,r.useEffect)(function(){n!==e.current&&null!=t.attributionControl&&(null!=e.current&&t.attributionControl.removeAttribution(e.current),null!=n&&t.attributionControl.addAttribution(n)),e.current=n},[t,n])}},6299:(t,n,e)=>{"use strict";e.r(n),e.d(n,{default:()=>b});var r=e(7876),o=e(4232),l=e(8847),i=e(3138),u=e(6724),a=e(7152),c=e(1937),s=e(6594),f=e(1173);e(1782);let d=JSON.parse('{"PolandballNik":"polandball"}');var p=e(9395),g=e(4279);function m(t){let n=1e4*Math.sin(9999*t);return n-Math.floor(n)}function h(t){let{location:n,gameOptions:e,round:l}=t,[a,c]=(0,o.useState)(2),s=(0,i.Po)({zoom:()=>c(s.getZoom())}),f=75*Math.pow(2,a-1),d=(null!=l?l:1)+Math.abs(75*n.lat+75*n.long),p=2*m(3*d)*Math.PI,g=Math.sqrt(m(7*d))*f,h=g*Math.cos(p),v=g*Math.sin(p),x=s.latLngToContainerPoint(L.latLng(n.lat,n.long)),y=L.point(x.x+h,x.y+v),b=s.containerPointToLatLng(y);return(0,r.jsx)(u.p,{center:b,radius:f,className:"hintCircle"})}let v=l(()=>e.e(572).then(e.bind(e,7191)).then(t=>t.MapContainer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1}),x=l(()=>e.e(572).then(e.bind(e,7191)).then(t=>t.TileLayer),{loadableGenerated:{webpack:()=>[require.resolveWeak("react-leaflet")]},ssr:!1});function y(t){let{pinPoint:n,setPinPoint:e,answerShown:r,dest:l,gameOptions:u,ws:a,multiplayerState:c,playSound:s}=t,f=o.useRef(c),d=o.useRef(a);(0,o.useEffect)(()=>{f.current=c},[c]),(0,o.useEffect)(()=>{d.current=a},[a]);let p=(0,i.Po)({click(t){var n,o,l;let i=f.current,u=d.current;if(!r&&(!(null==i?void 0:i.inGame)||(null==i?void 0:i.inGame)&&!(null==i||null==(o=i.gameData)||null==(n=o.players.find(t=>{var n;return t.id===(null==i||null==(n=i.gameData)?void 0:n.myId)}))?void 0:n.final))){if(e(t.latlng),(null==i?void 0:i.inGame)&&(null==(l=i.gameData)?void 0:l.state)==="guess"&&u){let n=[t.latlng.lat,t.latlng.lng];u.send(JSON.stringify({type:"place",latLong:n,final:!1}))}let n=L.latLngBounds([-90,-180],[90,180]);n.contains(t.latlng)||t.target.panInsideBounds(n,{animate:!0})}}});(0,o.useEffect)(()=>{let t=null==u?void 0:u.extent;p&&!r&&setTimeout(()=>{try{if(t){let n=L.latLngBounds([t[1],t[0]],[t[3],t[2]]);p.fitBounds(n)}else p.setView([30,0],2)}catch(t){}},500)},[(null==u?void 0:u.extent)?JSON.stringify(u.extent):null,p,r]),(0,o.useEffect)(()=>{n&&setTimeout(()=>{try{let t=L.latLngBounds([n,{lat:l.lat,lng:l.long}]).pad(.5);p.flyToBounds(t,{duration:.5})}catch(t){}},300)},[r]),(0,o.useEffect)(()=>{let t=setInterval(()=>{p.invalidateSize()},5);return()=>clearInterval(t)},[p])}let b=t=>{var n,e,l;let{shown:i,options:u,ws:m,session:b,pinPoint:w,setPinPoint:E,answerShown:j,location:C,setKm:z,guessing:P,multiplayerSentGuess:R,multiplayerState:k,showHint:O,round:S,focused:I,gameOptions:M}=t,T=o.useRef(null),U=o.useRef(),[N,B]=(0,o.useState)(!1),{t:A}=(0,f.B)("common");(0,o.useEffect)(()=>{let t=()=>{let t="ontouchstart"in window||navigator.maxTouchPoints>0,n=window.innerWidth<=1024;B(t||n)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);let K=(0,o.useMemo)(()=>({dest:L.icon({iconUrl:"./dest.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src:L.icon({iconUrl:"./src.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),src2:L.icon({iconUrl:"./src2.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34]}),polandball:L.icon({iconUrl:"./polandball.png",iconSize:[50,82],iconAnchor:[25,41],popupAnchor:[1,5]})}),[]);(0,o.useEffect)(()=>{if(j&&w&&C){let t=w.distanceTo({lat:C.lat,lng:C.long})/1e3;z(t=t>100?Math.round(t):t>10?parseFloat(t.toFixed(1)):parseFloat(t.toFixed(2)))}},[j,w,C]);let _=L.latLng(-180,-360),W=L.latLng(180,360);return L.latLngBounds(_,W),(0,r.jsxs)(v,{center:[0,0],zoom:2,minZoom:2,style:{height:"100%",width:"100%"},whenCreated:t=>{T.current=t},children:[(0,r.jsx)("div",{className:"mapAttr",children:(0,r.jsx)("img",{width:"60",src:"https://lh3.googleusercontent.com/d_S5gxu_S1P6NR1gXeMthZeBzkrQMHdI5uvXrpn3nfJuXpCjlqhLQKH_hbOxTHxFhp5WugVOEcl4WDrv9rmKBDOMExhKU5KmmLFQVg",alt:"Google"})}),(0,r.jsx)(y,{playSound:()=>{U.current.play()},pinPoint:w,setPinPoint:E,answerShown:j,dest:C,gameOptions:M,ws:m,multiplayerState:k}),C&&j&&(0,r.jsx)(a.p,{position:{lat:C.lat,lng:C.long},icon:K.dest}),w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{position:w,icon:"polandball"===d[null==b||null==(n=b.token)?void 0:n.username]?K.polandball:K.src,children:(0,r.jsx)(c.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:w.lat,lng:w.lng},children:A("yourGuess")})}),j&&C&&(0,r.jsx)(s.R,{positions:[w,{lat:C.lat,lng:C.long}]})]}),(null==k?void 0:k.inGame)&&j&&C&&(null==k||null==(e=k.gameData)?void 0:e.players.map((t,n)=>{var e;if(t.id===(null==k||null==(e=k.gameData)?void 0:e.myId)||!t.guess)return null;let o=(0,p.A)(t.username),l=[t.guess[0],t.guess[1]],i="polandball"===d[o]?K.polandball:K.src2;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.p,{position:{lat:l[0],lng:l[1]},icon:i,children:(0,r.jsx)(c.m,{direction:"top",offset:[0,-45],opacity:1,permanent:!0,position:{lat:l[0],lng:l[1]},children:(0,r.jsxs)("span",{style:{color:"black",display:"flex",alignItems:"center",gap:"4px"},children:[o,t.countryCode&&(0,r.jsx)(g.A,{countryCode:t.countryCode,style:{fontSize:"0.9em",marginRight:"0"}})]})})},2*n),(0,r.jsx)(s.R,{positions:[{lat:l[0],lng:l[1]},{lat:C.lat,lng:C.long}],color:"green"},2*n+1)]})})),O&&C&&(0,r.jsx)(h,{location:C,gameOptions:M,round:S}),(0,r.jsx)(x,{noWrap:!0,url:"https://mt{s}.google.com/vt/lyrs=".concat(null!=(l=null==u?void 0:u.mapType)?l:"m","&x={x}&y={y}&z={z}&hl=").concat(A("lang"),"&scale=2"),subdomains:["0","1","2","3"],attribution:'\xa9 <a href="https://maps.google.com">Google</a>',maxZoom:22},N?"mobile":"desktop"),(0,r.jsx)("audio",{ref:U,src:"/plop.mp3",preload:"auto"})]})}},6594:(t,n,e)=>{"use strict";e.d(n,{R:()=>u});var r=e(4986),o=e(2526),l=e(5073),i=e(2133);let u=(0,r.Lt)(function({positions:t,...n},e){let r=new i.Polyline(t,n);return(0,o.Q)(r,(0,l.W4)(e,{overlayContainer:r}))},function(t,n,e){n.positions!==e.positions&&t.setLatLngs(n.positions)})},6724:(t,n,e)=>{"use strict";e.d(n,{p:()=>a});var r=e(4986),o=e(2526),l=e(5073),i=e(9594),u=e(2133);let a=(0,r.Lt)(function({center:t,children:n,...e},r){let i=new u.CircleMarker(t,e);return(0,o.Q)(i,(0,l.W4)(r,{overlayContainer:i}))},i.s)},7152:(t,n,e)=>{"use strict";e.d(n,{p:()=>u});var r=e(4986),o=e(2526),l=e(5073),i=e(2133);let u=(0,r.Nq)(function({position:t,...n},e){let r=new i.Marker(t,n);return(0,o.Q)(r,(0,l.W4)(e,{overlayContainer:r}))},function(t,n,e){n.position!==e.position&&t.setLatLng(n.position),null!=n.icon&&n.icon!==e.icon&&t.setIcon(n.icon),null!=n.zIndexOffset&&n.zIndexOffset!==e.zIndexOffset&&t.setZIndexOffset(n.zIndexOffset),null!=n.opacity&&n.opacity!==e.opacity&&t.setOpacity(n.opacity),null!=t.dragging&&n.draggable!==e.draggable&&(!0===n.draggable?t.dragging.enable():t.dragging.disable())})},8420:(t,n,e)=>{"use strict";function r(t,n){let e=t.pane??n.pane;return e?{...t,pane:e}:t}e.d(n,{P:()=>r})},9594:(t,n,e)=>{"use strict";function r(t,n,e){n.center!==e.center&&t.setLatLng(n.center),null!=n.radius&&n.radius!==e.radius&&t.setRadius(n.radius)}e.d(n,{s:()=>r})}}]);