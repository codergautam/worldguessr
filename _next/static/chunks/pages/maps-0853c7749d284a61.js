(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{420:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/maps",function(){return o(4972)}])},858:(e,t,o)=>{"use strict";o.d(t,{W:()=>s,a:()=>r});let n=[];function r(){try{return window.self!==window.top}catch(e){return!0}}function s(){try{return r()&&n.some(e=>{var t,o,n;return(null!=(n=null==(o=window)||null==(t=o.location)?void 0:t.ancestorOrigins[0])?n:document.referrer).includes(e)})}catch(e){return console.error("Piracy detection error",e),!1}}},4972:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>d});var n=o(7876),r=o(4232),s=o(9099),i=o(9701),a=o(1173),c=o(3603),l=o(6336),h=o(7328);let u={open:!1,progress:!1,name:"",description_short:"",description_long:"",data:"",edit:!1,mapId:""};function d(e){let{}=e,t=(0,s.useRouter)(),{t:o}=(0,a.B)("common"),{data:d,status:w}=(0,l.wV)(),[p,m]=(0,r.useState)(u),[f,y]=(0,r.useState)(""),[v,A]=(0,r.useState)([]);return(0,r.useEffect)(()=>{window.cConfig=(0,c.A)()},[]),(0,n.jsxs)("div",{style:g.pageContainer,children:[(0,n.jsx)(h,{children:(0,n.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Jockey+One&display=swap",rel:"stylesheet"})}),(0,n.jsx)("div",{style:g.pageContent,children:(0,n.jsx)(i.A,{showOptions:!1,showAllCountriesOption:!1,chosenMap:void 0,close:()=>t.back(),session:d,text:o,onMapClick:e=>{t.push("/map?s=".concat(e.slug))},gameOptions:void 0,setGameOptions:void 0,makeMap:p,setMakeMap:m,initMakeMap:u,searchTerm:f,setSearchTerm:y,searchResults:v,setSearchResults:A})})]})}let g={pageContainer:{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",background:"linear-gradient(135deg, rgba(0, 0, 0, 0.98) 0%, rgba(0, 10, 5, 0.95) 50%, rgba(0, 0, 0, 0.98) 100%)"},pageContent:{background:"linear-gradient(135deg, rgba(5, 15, 8, 0.98) 0%, rgba(2, 8, 4, 0.99) 100%)",width:"calc(100vw - 40px)",height:"100vh",overflowY:"auto",borderRadius:"8px",padding:"20px",position:"relative"}}},6336:(e,t,o)=>{"use strict";o.d(t,{CI:()=>a,Jv:()=>c,dJ:()=>h,wV:()=>l});var n=o(858),r=o(2446),s=o(8207);let i=!1;function a(){window.localStorage.removeItem("wg_secret"),i=null,window.dontReconnect||(console.log("Removing cookies"),function(){for(var e=document.cookie.split("; "),t=0;t<e.length;t++)for(var o=window.location.hostname.split(".");o.length>0;){var n=encodeURIComponent(e[t].split(";")[0].split("=")[0])+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain="+o.join(".")+" ;path=",r=location.pathname.split("/");for(document.cookie=n+"/";r.length>0;)document.cookie=n+r.join("/"),console.log(n+r.join("/")),r.pop();o.shift()}}(),window.location.reload())}function c(){if(console.log("Signing in"),(0,n.a)()){console.log("In iframe");let e=window.location.href;window.open(e,"_blank")}window.login()}function l(){var e,t;if(window.location.hostname.includes("crazygames")&&window.verifyPayload&&"not_logged_in"===JSON.parse(window.verifyPayload).secret)return{data:null};if(!1===i&&!window.fetchingSession&&(null==(e=window.cConfig)?void 0:e.apiUrl)){let e=null;try{e=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}e?(window.fetchingSession=!0,console.log("[Auth] Starting authentication with retry mechanism"),s.A.fetchWithRetry((null==(t=window.cConfig)?void 0:t.apiUrl)+"/api/googleAuth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:e})},"googleAuth").then(e=>e.json()).then(e=>{if(window.fetchingSession=!1,console.log("[Auth] Authentication successful"),e.error){console.error("[Auth] Server error:",e.error),i=null;return}e.secret?(window.localStorage.setItem("wg_secret",e.secret),i={token:e},console.log("[Auth] Session established for user:",e.username)):(console.log("[Auth] No session data received, user not logged in"),i=null)}).catch(e=>{window.fetchingSession=!1,console.error("[Auth] Authentication failed after all retries:",e.message);try{window.localStorage.removeItem("wg_secret")}catch(e){console.warn("[Auth] Could not clear localStorage:",e)}i=null,s.A.getRetryCount("googleAuth")>=5&&r.oR.error("Connection issues detected. Please refresh the page if problems persist.")})):i=null}return{data:i}}function h(){var e;let t=null;if(i&&(null==i||null==(e=i.token)?void 0:e.secret))t=i.secret;else try{t=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}return t?{Authorization:"Bearer "+t}:{}}},7328:(e,t,o)=>{e.exports=o(9836)},8207:(e,t,o)=>{"use strict";o.d(t,{A:()=>r});class n{async fetchWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=this.retryAttempts.get(o)||0;console.log("[RetryFetch] Attempting ".concat(o," (attempt ").concat(n+1,"/").concat(this.maxRetries+1,")"));try{let n=new AbortController,r=setTimeout(()=>n.abort(),1e4),s=await fetch(e,{...t,signal:n.signal});if(clearTimeout(r),!s.ok)throw Error("HTTP ".concat(s.status,": ").concat(s.statusText));return this.retryAttempts.delete(o),console.log("[RetryFetch] Success for ".concat(o)),s}catch(r){if(console.warn("[RetryFetch] Error for ".concat(o,":"),r.message),n<this.maxRetries&&this.shouldRetry(r)){let r=Math.min(this.baseDelay*Math.pow(2,n),this.maxDelay);return console.log("[RetryFetch] Retrying ".concat(o," in ").concat(r,"ms...")),this.retryAttempts.set(o,n+1),new Promise(n=>{setTimeout(()=>{n(this.fetchWithRetry(e,t,o))},r)})}throw console.error("[RetryFetch] Failed ".concat(o," after ").concat(n+1," attempts:"),r.message),this.retryAttempts.delete(o),r}}shouldRetry(e){return"AbortError"===e.name||"TypeError"===e.name||e.message&&e.message.includes("fetch")||e.message&&e.message.includes("HTTP 5")}resetRetries(e){this.retryAttempts.delete(e),console.log("[RetryFetch] Reset retry count for ".concat(e))}getRetryCount(e){return this.retryAttempts.get(e)||0}constructor(){this.retryAttempts=new Map,this.maxRetries=5,this.baseDelay=1e3,this.maxDelay=3e4}}let r=new n}},e=>{e.O(0,[938,585,535,479,701,636,593,792],()=>e(e.s=420)),_N_E=e.O()}]);