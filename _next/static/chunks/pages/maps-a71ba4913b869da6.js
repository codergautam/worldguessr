(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{420:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/maps",function(){return o(4972)}])},858:(e,t,o)=>{"use strict";o.d(t,{W:()=>i,a:()=>r});let n=[];function r(){try{return window.self!==window.top}catch(e){return!0}}function i(){try{return r()&&n.some(e=>{var t,o,n;return(null!=(n=null==(o=window)||null==(t=o.location)?void 0:t.ancestorOrigins[0])?n:document.referrer).includes(e)})}catch(e){return console.error("Piracy detection error",e),!1}}},3603:(e,t,o)=>{"use strict";function n(){var e;let t=!window||"https:"===window.location.protocol;return{apiUrl:(t?"https":"http")+"://api.worldguessr.com",websocketUrl:(t?"wss":"ws")+"://"+((e="server.worldguessr.com",void 0!==e)?e:"localhost:3002")+"/wg"}}o.d(t,{A:()=>n})},4972:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>d});var n=o(7876),r=o(4232),i=o(9099),s=o(9701),c=o(1173),a=o(3603),l=o(6336),u=o(7328);let h={open:!1,progress:!1,name:"",description_short:"",description_long:"",data:"",edit:!1,mapId:""};function d(e){let{}=e,t=(0,i.useRouter)(),{t:o}=(0,c.B)("common"),{data:d,status:p}=(0,l.wV)(),[f,w]=(0,r.useState)(h),[m,y]=(0,r.useState)(""),[v,T]=(0,r.useState)([]);return(0,r.useEffect)(()=>{window.cConfig=(0,a.A)()},[]),(0,n.jsxs)("div",{style:g.pageContainer,children:[(0,n.jsx)(u,{children:(0,n.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Jockey+One&display=swap",rel:"stylesheet"})}),(0,n.jsx)("div",{style:g.pageContent,children:(0,n.jsx)(s.A,{showOptions:!1,showAllCountriesOption:!1,chosenMap:void 0,close:()=>t.back(),session:d,text:o,onMapClick:e=>{t.push("/map?s=".concat(e.slug))},gameOptions:void 0,setGameOptions:void 0,makeMap:f,setMakeMap:w,initMakeMap:h,searchTerm:m,setSearchTerm:y,searchResults:v,setSearchResults:T})})]})}let g={pageContainer:{width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",background:"linear-gradient(135deg, rgba(0, 0, 0, 0.98) 0%, rgba(0, 10, 5, 0.95) 50%, rgba(0, 0, 0, 0.98) 100%)"},pageContent:{background:"linear-gradient(135deg, rgba(5, 15, 8, 0.98) 0%, rgba(2, 8, 4, 0.99) 100%)",width:"calc(100vw - 40px)",height:"100vh",overflowY:"auto",borderRadius:"8px",padding:"20px",position:"relative"}}},5364:(e,t,o)=>{"use strict";var n,r;e.exports=(null==(n=o.g.process)?void 0:n.env)&&"object"==typeof(null==(r=o.g.process)?void 0:r.env)?o.g.process:o(5861)},5861:e=>{!function(){var t={229:function(e){var t,o,n,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(o){try{return t.call(null,e,0)}catch(o){return t.call(this,e,0)}}}var a=[],l=!1,u=-1;function h(){l&&n&&(l=!1,n.length?a=n.concat(a):u=-1,a.length&&d())}function d(){if(!l){var e=c(h);l=!0;for(var t=a.length;t;){for(n=a,a=[];++u<t;)n&&n[u].run();u=-1,t=a.length}n=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];a.push(new g(e,t)),1!==a.length||l||c(d)},g.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},o={};function n(e){var r=o[e];if(void 0!==r)return r.exports;var i=o[e]={exports:{}},s=!0;try{t[e](i,i.exports,n),s=!1}finally{s&&delete o[e]}return i.exports}n.ab="//",e.exports=n(229)}()},6336:(e,t,o)=>{"use strict";o.d(t,{CI:()=>l,Jv:()=>u,dJ:()=>d,wV:()=>h});var n=o(858);o(2446);var r=o(8207),i=o(4232);let s=!1,c=new Set;function a(){c.forEach(e=>e(s))}function l(){window.localStorage.removeItem("wg_secret"),s=null,a(),window.dontReconnect||(console.log("Removing cookies"),function(){for(var e=document.cookie.split("; "),t=0;t<e.length;t++)for(var o=window.location.hostname.split(".");o.length>0;){var n=encodeURIComponent(e[t].split(";")[0].split("=")[0])+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain="+o.join(".")+" ;path=",r=location.pathname.split("/");for(document.cookie=n+"/";r.length>0;)document.cookie=n+r.join("/"),console.log(n+r.join("/")),r.pop();o.shift()}}(),window.location.reload())}function u(){if(console.log("Signing in"),(0,n.a)()){console.log("In iframe");let e=window.location.href;window.open(e,"_blank")}window.login()}function h(){var e,t;let[,o]=(0,i.useState)(s);if((0,i.useEffect)(()=>{let e=e=>{o(e)};return c.add(e),()=>c.delete(e)},[]),window.location.hostname.includes("crazygames")&&window.verifyPayload&&"not_logged_in"===JSON.parse(window.verifyPayload).secret)return{data:null};if(!1===s&&!window.fetchingSession&&(null==(e=window.cConfig)?void 0:e.apiUrl)){let e=null;try{e=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}if(e){window.fetchingSession=!0;let o=performance.now();console.log("[Auth] Starting authentication with retry mechanism (5s timeout, unlimited retries)"),r.A.fetchWithRetry((null==(t=window.cConfig)?void 0:t.apiUrl)+"/api/googleAuth",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:e})},"googleAuth",{timeout:5e3,maxRetries:1/0,baseDelay:1e3,maxDelay:1e4}).then(e=>e.json()).then(e=>{window.fetchingSession=!1;let t=(performance.now()-o).toFixed(0);if(console.log("[Auth] Authentication successful (took ".concat(t,"ms)")),e.error){console.error("[Auth] Server error:",e.error),s=null,a();return}e.secret?(window.localStorage.setItem("wg_secret",e.secret),s={token:e},console.log("[Auth] Session established for user:",e.username)):(console.log("[Auth] No session data received, user not logged in"),s=null),a()}).catch(e=>{window.fetchingSession=!1;let t=(performance.now()-o).toFixed(0);console.error("[Auth] Authentication failed (took ".concat(t,"ms):"),e.message);try{window.localStorage.removeItem("wg_secret")}catch(e){console.warn("[Auth] Could not clear localStorage:",e)}s=null,a()})}else s=null,a()}return{data:s}}function d(){var e;let t=null;if(s&&(null==s||null==(e=s.token)?void 0:e.secret))t=s.secret;else try{t=window.localStorage.getItem("wg_secret")}catch(e){console.error(e)}return t?{Authorization:"Bearer "+t}:{}}},7328:(e,t,o)=>{e.exports=o(9836)},8207:(e,t,o)=>{"use strict";o.d(t,{A:()=>r});class n{async fetchWithRetry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{timeout:r=1e4,maxRetries:i=this.maxRetries,baseDelay:s=this.baseDelay,maxDelay:c=this.maxDelay}=n,a=i===1/0?1e3:i,l=this.retryAttempts.get(o)||0;console.log("[RetryFetch] Attempting ".concat(o," (attempt ").concat(l+1,"/").concat(i===1/0?"âˆž":a+1,")"));let u=new AbortController,h=setTimeout(()=>u.abort(),r);try{let n=await fetch(e,{...t,signal:u.signal});if(clearTimeout(h),!n.ok)throw Error("HTTP ".concat(n.status,": ").concat(n.statusText));return this.retryAttempts.delete(o),console.log("[RetryFetch] Success for ".concat(o)),n}catch(r){if(clearTimeout(h),console.warn("[RetryFetch] Error for ".concat(o,":"),r.message),l<a&&this.shouldRetry(r)){let r=Math.min(s*Math.pow(2,l),c);return console.log("[RetryFetch] Retrying ".concat(o," in ").concat(r,"ms...")),this.retryAttempts.set(o,l+1),new Promise((i,s)=>{setTimeout(()=>{this.fetchWithRetry(e,t,o,n).then(i).catch(s)},r)})}throw console.error("[RetryFetch] Failed ".concat(o," after ").concat(l+1," attempts:"),r.message),this.retryAttempts.delete(o),r}}shouldRetry(e){return"AbortError"===e.name||"TypeError"===e.name||e.message&&e.message.includes("fetch")||e.message&&e.message.includes("HTTP 5")}resetRetries(e){this.retryAttempts.delete(e),console.log("[RetryFetch] Reset retry count for ".concat(e))}getRetryCount(e){return this.retryAttempts.get(e)||0}constructor(){this.retryAttempts=new Map,this.maxRetries=5,this.baseDelay=1e3,this.maxDelay=3e4}}let r=new n},9099:(e,t,o)=>{e.exports=o(8253)}},e=>{e.O(0,[938,585,535,173,701,636,593,792],()=>e(e.s=420)),_N_E=e.O()}]);